define(["require","exports","../common/models","../common/scriptExecutionModels","knockout","../common/dataAccessService","../common/messageService","../common/odtUtils","ojs/ojdialog","ojs/ojinputtext","ojs/ojlabel","ojs/ojlabelvalue"],(function(require,e,t,s,a,r,i,n){"use strict";return class{constructor(e){this.operationNameField=a.observable(s.OperationName.None),this.secure=a.observable(!0),this.mandatoryField=a.observable(!1),this.disableUserInputField=a.observable(!1),this.labelHintField=a.observable(""),this.valueField=a.observable(),this.promptTextField=a.observable(),this.validateUserInput=()=>{if(this.isUserInputValid=this.validate(),this.isUserInputValid){const e=this.PrepareDataForRequest(!1);r.DataAccessService.instance.sendUserInput(e),r.DataAccessService.instance.logInfo("ValuesSentToServer "+s.UserInputParams.displayString(e))}else i.MessagesService.getinstance().ShowMessage("Input is invalid.",t.Severity.error);return this.isUserInputValid};this.inputArgs=e;let n=e.parameters.inputVariables?e.parameters.inputVariables[0]:void 0;e&&(e.isInputValid=this.validateUserInput,this.operationName=e.parameters.operationName,e.onOk=()=>this.validateUserInput(),e.onCancel=()=>{const e=this.PrepareDataForRequest(!0);return e.cancelScript=!0,r.DataAccessService.instance.sendUserInput(e),r.DataAccessService.instance.logInfo("ValuesSentToServer "+s.UserInputParams.displayString(e)),!0}),n&&(this.promptText=n.promptText,this.value=n.value?n.value:"",this.isSecure=n.isPassword,this.mandatory=n.mandatory,this.mandatoryField.subscribe(e=>{this.labelHintField(e?"required":"")}))}get operationName(){return this.operationNameField()}set operationName(e){this.operationNameField(e)}validate(){return this.operationName===s.OperationName.UnsupportedCommandPrompt||this.operationName===s.OperationName.PromptConnectionReconnect||!(this.mandatory&&!this.value)}PrepareDataForRequest(e){let t,a=new s.UserInputParams;return a.queryId=this.inputArgs.parameters.queryId,a.ownerUri=this.inputArgs.parameters.ownerUri,a.executionId=this.inputArgs.parameters.executionId,a.inputVariables=this.inputArgs.parameters.inputVariables,t=this.inputArgs.parameters.operationName==s.OperationName.Password?n.ODTUtils.toCodePointArray(this.value):this.operationName===s.OperationName.UnsupportedCommandPrompt||(this.operationName===s.OperationName.PromptConnectionReconnect?!e:this.value),a.inputVariables[0].value=t,a}get disableUserInput(){return this.disableUserInputField()}set disableUserInput(e){this.disableUserInputField(e)}get mandatory(){return this.mandatoryField()}set mandatory(e){this.mandatoryField(e)}get isSecure(){return this.secure()}set isSecure(e){this.secure(e)}get value(){return this.valueField()}set value(e){this.valueField(e)}get promptText(){return this.promptTextField()}set promptText(e){this.promptTextField(e)}}}));