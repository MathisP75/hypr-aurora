/**
 * @license
 * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["ojs/ojeditablevalue","ojs/ojlistview","ojs/ojpopupcore","ojs/ojinputtext","ojs/ojhighlighttext","ojs/ojcore-base","jquery","ojs/ojcontext","ojs/ojdomutils","ojs/ojlogger","ojs/ojconfig","ojs/ojfocusutils","ojs/ojkeyset","ojs/ojcomponentcore","ojs/ojthemeutils","ojs/ojcachingdataprovider","ojs/ojlistdataproviderview","ojs/ojtreedataproviderview","ojs/ojdataprovider","ojs/ojtimerutils","ojs/ojcustomelement-utils"],function(e,t,i,n,r,o,s,a,l,d,u,c,h,p,_,v,f,m,y,b,g){"use strict";o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o,s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,c=c&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c,v=v&&Object.prototype.hasOwnProperty.call(v,"default")?v.default:v,f=f&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f,m=m&&Object.prototype.hasOwnProperty.call(m,"default")?m.default:m;
/**
   * @license
   * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */
var E={properties:{data:{type:"DataProvider"},describedBy:{type:"string"},disabled:{type:"boolean",value:!1},displayOptions:{type:"object",properties:{helpInstruction:{type:"Array<string>|string",value:["notewindow"]},messages:{type:"Array<string>|string"}}},help:{type:"object",properties:{instruction:{type:"string",value:""}}},helpHints:{type:"object",properties:{definition:{type:"string",value:""},source:{type:"string",value:""}}},itemText:{type:"string|function",value:"label"},labelEdge:{type:"string",enumValues:["inside","none","provided"]},labelHint:{type:"string",value:""},labelledBy:{type:"string"},messagesCustom:{type:"Array<Object>",writeback:!0,value:[]},placeholder:{type:"string",value:""},readonly:{type:"boolean",value:!1},required:{type:"boolean",value:!1},translations:{type:"object",value:{},properties:{cancel:{type:"string"},labelAccClearValue:{type:"string"},labelAccOpenDropdown:{type:"string"},multipleMatchesFound:{type:"string"},nOrMoreMatchesFound:{type:"string"},noMatchesFound:{type:"string"},noResultsLine1:{type:"string"},noResultsLine2:{type:"string"},oneMatchFound:{type:"string"},required:{type:"object",properties:{hint:{type:"string"},messageDetail:{type:"string"},messageSummary:{type:"string"}}}}},userAssistanceDensity:{type:"string",enumValues:["compact","efficient","reflow"],value:"reflow"},valid:{type:"string",writeback:!0,enumValues:["invalidHidden","invalidShown","pending","valid"],readOnly:!0},value:{type:"any",writeback:!0},valueItem:{type:"object",writeback:!0,value:{key:null,data:null,metadata:null}},virtualKeyboard:{type:"string",enumValues:["email","number","search","tel","text","url"],value:"search"}},methods:{getProperty:{},refresh:{},reset:{},setProperties:{},setProperty:{},showMessages:{},validate:{},getNodeBySubId:{},getSubIdByNode:{}},events:{ojAnimateEnd:{},ojAnimateStart:{},ojValueAction:{}},extension:{}};E.extension._WIDGET_NAME="ojSelect2",E.extension._INNER_ELEM="input",E.extension._ALIASED_PROPS={readonly:"readOnly"},oj.CustomElementBridge.register("oj-select-single",{metadata:oj.CollectionUtils.mergeDeep(E,{properties:{readonly:{binding:{consume:{name:"readonly"}}},userAssistanceDensity:{binding:{consume:{name:"userAssistanceDensity"}}},labelEdge:{binding:{consume:{name:"labelEdge"}}}}})});
/**
   * @license
   * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */
var w,S={KEYS:{TAB:9,ENTER:13,ESC:27,SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,SHIFT:16,CTRL:17,ALT:18,PAGE_UP:33,PAGE_DOWN:34,HOME:36,END:35,BACKSPACE:8,DELETE:46},_isControlKey:function(e){switch(e.which){case S.KEYS.SHIFT:case S.KEYS.CTRL:case S.KEYS.ALT:return!0;default:return e.metaKey||e.ctrlKey}},_isFunctionKey:function(e){var t=e.which?e.which:e;return t>=112&&t<=123},isControlOrFunctionKey:function(e){return S._isControlKey(e)||S._isFunctionKey(e)},nextUid:(w=1,function(){var e=w;return w+=1,e}),killEvent:function(e){e.preventDefault()},stopEventPropagation:function(e){e.stopPropagation()},addBusyState:function(e,t){var i={description:"The component identified by '"+e.id+"' "+t};return a.getContext(e).getBusyContext().addBusyState(i)},createValueItem:function(e,t,i){return{key:e,data:t,metadata:i}},dispatchCustomEvent:function(e,t,i,n){var r=n||{};r.subtype=i;var o={bubbles:!1,cancelable:!1,detail:r};return e.dispatchEvent(new CustomEvent(t,o))},isValueItemForPlaceholder:function(e){return null==e||S.isValueForPlaceholder(e.key)},isValueForPlaceholder:function(e){return null==e},copyAttribute:function(e,t,i,n){var r=e.getAttribute(t);null===r?i.removeAttribute(n):i.setAttribute(n,r)}},P=function(e){this._addBusyStateFunc=e.addBusyStateFunc,this._forceReadOnly=e.forceReadOnly,this._createOrUpdateReadonlyDivFunc=e.createOrUpdateReadonlyDivFunc,this._containerElem=this._createInnerDom(e);var t=s(this._containerElem).find("input."+e.className+"-input");this._inputElem=t[0]};
/**
   * @license
   * Copyright (c) 2018 2021, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */P.prototype.getElement=function(){return this._containerElem},P.prototype.getInputElem=function(){return this._inputElem},P.prototype.getInputText=function(){return this._inputElem.value||""},P.prototype._createInnerDom=function(e){var t=e.className,i=e.idSuffix,n=e.inputType,r=e.enabled,o=e.readOnly,s=e.ariaLabel,a=e.ariaControls,l=e.cachedMainFieldInputElement,d=document.createElement("div");d.setAttribute("class","oj-text-field-container oj-searchselect-main-field"),d.setAttribute("role","presentation");var u=document.createElement("div");u.setAttribute("class","oj-text-field-middle"),d.appendChild(u);var c=l||document.createElement("input");return c.setAttribute("id",t+"-input-"+i),c.setAttribute("autocomplete","off"),c.setAttribute("autocorrect","off"),c.setAttribute("autocapitalize","off"),c.setAttribute("spellcheck","false"),c.setAttribute("class",t+"-input oj-text-field-input"),c.setAttribute("aria-autocomplete","list"),c.setAttribute("placeholder",e.placeholder),c.disabled=!r&&!o,(o||this._forceReadOnly&&r)&&c.setAttribute("readonly","true"),o||(c.setAttribute("role","combobox"),c.setAttribute("aria-expanded","false")),s&&c.setAttribute("aria-label",s),a&&c.setAttribute("aria-controls",a),null!==n&&""!==n?c.setAttribute("type",n):c.setAttribute("type","text"),u.appendChild(c),e.endContent&&d.appendChild(e.endContent),o&&this._createOrUpdateReadonlyDivFunc(c),d},P.prototype.updateLabel=function(e,t){e?(this._inputElem.setAttribute("aria-labelledby",e),this._inputElem.removeAttribute("aria-label")):t&&(this._inputElem.setAttribute("aria-label",t),this._inputElem.removeAttribute("aria-labelledby"))};
/**
   * @license
   * Copyright (c) 2018 2021, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */
var F=function(e){this._minLength=0,this._className=e.className,this._dataProvider=e.dataProvider,this._containerElem=e.containerElem,this._fullScreenPopup=e.fullScreenPopup,this._idSuffix=e.idSuffix,this._enabled=e.enabled,this._readonly=e.readOnly,this._value=e.value,this._getTranslatedStringFunc=e.getTranslatedStringFunc,this._addBusyStateFunc=e.addBusyStateFunc,this._lovMainField=e.lovMainField,this._filterInputText=e.filterInputText,this._lovDropdown=e.lovDropdown,this._liveRegion=e.liveRegion,this._showMainFieldFunc=e.showMainFieldFunc,this._setFilterFieldTextFunc=e.setFilterFieldTextFunc,this._setUiLoadingStateFunc=e.setUiLoadingStateFunc,this._lastDataProviderPromise=null,this._fetchType=this.hasData()?"init":null};F.prototype.setValue=function(e){this._value=e},F.prototype.getFetchType=function(){return this._fetchType},F.prototype.destroy=function(){var e=this._closeDelayTimer;isNaN(e)||(delete this._closeDelayTimer,window.clearTimeout(e)),this.closeDropdown()},F.prototype.hasData=function(){return null!=this._dataProvider},F.prototype.isDropdownOpen=function(){return s(this._containerElem).hasClass("oj-listbox-dropdown-open")},F.prototype._usingHandler=function(e,t){if(o.PositionUtils.isAligningPositionClipped(t)){var i=this._addBusyStateFunc("closing popup");this._closeDelayTimer=window.setTimeout(function(){this.closeDropdown(),i()}.bind(this),1)}else{var n=s(this._containerElem),r=this._lovDropdown.getElement(),a=s(r),l=o.PositionUtils.calcAvailablePopupSize(e,t),d=r.style;e.left>=0&&(d.maxWidth=l.width+"px"),d.maxHeight=l.height+"px";var u=this.getDropdownPosition(!0);a.position(u),"bottom"===t.vertical?(n.addClass("oj-listbox-drop-above"),a.addClass("oj-listbox-drop-above")):(n.removeClass("oj-listbox-drop-above"),a.removeClass("oj-listbox-drop-above"))}},F.prototype.getDropdownPosition=function(e){var t;if(this._fullScreenPopup){var i=window.scrollX||window.pageXOffset,n=window.scrollY||window.pageYOffset;t={my:"start top",at:"start top",of:window,offset:{x:i,y:n}}}else t={my:"start top",at:"start bottom",of:this._lovMainField.getElement(),collision:"flip"},e||(t.using=this._usingHandler.bind(this));var r="rtl"===l.getReadingDirection();return o.PositionUtils.normalizeHorizontalAlignment(t,r)},F.prototype.sizeDropdown=function(){var e=this._lovDropdown.getElement();if(this._fullScreenPopup){var t=Math.min(window.innerWidth,window.screen.availWidth),i=Math.min(window.innerHeight,window.screen.availHeight);if("phone"===u.getDeviceType()&&window.parent&&window!==window.parent){var n=Math.min(window.parent.innerHeight,window.parent.screen.availHeight),r=Math.min(i,n);if(i>r){var o=i-r;e.style.paddingBottom=o+"px"}}e.style.width=t+"px",e.style.height=i+"px"}else e.style.minWidth=s(this._containerElem).width()+"px"},F.prototype.openDropdown=function(e){if(this.isDropdownOpen()||!1===this._enabled||!0===this._readonly)return!1;if(this._fullScreenPopup){var t=this._lovMainField.getInputElem();this._setFilterFieldTextFunc(t.value)}return s(this._containerElem).addClass("oj-listbox-dropdown-open"),e||this.updateResults(!0,this._fullScreenPopup),!0},F.prototype.closeDropdown=function(){if(this.isDropdownOpen()){var e=s(this._containerElem);e.removeClass("oj-listbox-dropdown-open"),this._ariaExpanded&&(e.removeClass("oj-listbox-drop-above"),s(this._lovDropdown.getElement()).removeClass("oj-listbox-drop-above"),this._lovDropdown.close(),this._ariaExpanded=!1,this._lovMainField.getInputElem().setAttribute("aria-expanded","false"),this._lastSearchTerm=null)}},F.prototype.updateResults=function(e,t){var i;i=!0===e?"":this._filterInputText.rawValue||"";var n=this._lastSearchTerm;if(!0===e||!n||i!==n){var r=this._lovDropdown.getElement().classList;!0===e?r.add("oj-listbox-initial-open"):r.remove("oj-listbox-initial-open"),this._lastSearchTerm=i,i.length>=this._minLength?e&&!0!==e?this._runQuery(i,t):this._runQuery(i,t,!0===e):this.closeDropdown()}},F.prototype._runQuery=function(e,t,i){var n=this._lovDropdown;if(this._minLength>e.length)this.closeDropdown();else if(this.openDropdown(!0),this.hasData()){this._ariaExpanded||(n.open(),this._ariaExpanded=!0,this._lovMainField.getInputElem().setAttribute("aria-expanded","true")),t&&!this._fullScreenPopup&&c.focusFirstTabStop(n.getElement());var r=this._fetchFromDataProvider(e,i);r.then(function(){r===this._lastDataProviderPromise&&this._handleQueryResultsFetch(t)}.bind(this),function(e){r===this._lastDataProviderPromise&&(d.warn("Select: _fetchFromDataProvider promise was rejected: "+e),this._handleQueryResultsFetch(t))}.bind(this))}},F.prototype._handleQueryResultsFetch=function(e){if(this.isDropdownOpen()){this._lovDropdown.getElement().classList.remove("oj-listbox-initial-open");var t,i=this._lovDropdown.getResultsCount(),n=i?i.count:0,r=!i||i.done;0===n?t=this._getTranslatedStringFunc("noMatchesFound"):(this.sizeDropdown(),t=r?this._getTranslatedStringFunc("multipleMatchesFound",{num:String(n)}):this._getTranslatedStringFunc("nOrMoreMatchesFound",{num:String(n)})),this.updateLiveRegion(t),e&&this._fullScreenPopup&&c.focusFirstTabStop(this._lovDropdown.getElement())}},F.prototype.updateLiveRegion=function(e){s(this._liveRegion).text(e)},F.prototype.cancel=function(){this.closeDropdown()},F.prototype.handleDataProviderEvent=function(e){this._lastSearchTerm=null},F.prototype._fetchFromDataProvider=function(e,t){var i=!1,n=this._addBusyStateFunc("fetching data");"init"===this._fetchType&&(this.isDropdownOpen()||(i=!0,this._setUiLoadingStateFunc("start")),this._fetchType=null);var r=null;if(e){if(this._dataProvider){var s=this._dataProvider.getCapability("filter");s&&s.textFilter||d.error("Select: DataProvider does not support text filter.  Filtering results in dropdown may not work correctly.")}r=o.FilterFactory.getFilter({filterDef:{text:e}})}var a=new Promise(function(o,s){var l=this._lovDropdown.renderResults(e,r,S.isValueForPlaceholder(this._value)?null:this._value,t),u=function(){i&&this._setUiLoadingStateFunc("stop"),n(),a===this._lastDataProviderPromise?o():s("AbstractLovBase._fetchFromDataProvider: rejecting earlier promise")}.bind(this);l.then(function(){u()},function(e){a===this._lastDataProviderPromise&&d.warn("Select: renderResults promise was rejected: "+e),u()})}.bind(this));return this._lastDataProviderPromise=a,a};
/**
   * @license
   * Copyright (c) 2018 2021, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */
var C=function(){};C.prototype.init=function(e){this._dataProvider=e.dataProvider,this._fullScreenPopup=e.fullScreenPopup,this._bodyElem=s(e.bodyElem),this._itemTemplate=e.itemTemplate,this._collectionTemplate=e.collectionTemplate,this._getTemplateEngineFunc=e.getTemplateEngineFunc,this._templateContextComponentElement=e.templateContextComponentElement,this._addBusyStateFunc=e.addBusyStateFunc,this._itemTextRendererFunc=e.itemTextRendererFunc,this._filterInputText=e.filterInputText,this._getThrottlePromiseFunc=e.getThrottlePromiseFunc,this._currentFirstItem=null,this._templateEngine=null,this._resultsCount=null,this._NO_RESULTS_FOUND_CLASSNAME="oj-listbox-searchselect-no-results";var t=this._addBusyStateFunc("LovDropdown initializing");this._addDataProviderEventListeners();var i,n,r=this._createInnerDom(e);this._containerElem=r,this._dropdownPositioningProxyContainer=this._createDropdownPositioningProxyElem(e);var o=new Promise(function(e,t){i=e,n=t});this._collectionContext={parentElement:this._containerElem[0],idSuffix:e.idSuffix,renderDone:i,renderError:n,data:this._dataProvider,searchText:void 0,selected:void 0,selectedItem:void 0,selectedItemChangedListener:this._handleCollectionSelectedItemChanged.bind(this),currentRow:{rowIndex:void 0,rowKey:void 0},currentRowChangedListener:this._handleCollectionCurrentRowChanged.bind(this),currentRowKeyChangedListener:this._handleCollectionCurrentRowKeyChanged.bind(this),handleRowAction:this._handleRowAction.bind(this)},this._collectionRendererFunc=this._collectionTemplate?this._templateCollectionRenderer.bind(this):this._defaultCollectionRenderer.bind(this),this._collectionRendererFunc(this._collectionContext),r.on("change","."+e.className+"-input",S.stopEventPropagation),r.on("click mouseup mousedown",S.stopEventPropagation);var a=function(){e.afterDropdownInitFunc&&e.afterDropdownInitFunc(this._resultsElem[0]),t()}.bind(this);if(o.then(a,a),r.on("keydown",this._handleKeyDown.bind(this)),this._updateLabelFunc){var l=this._updateLabelFunc;this._updateLabelFunc=null,l()}},C.prototype._dispatchEvent=function(e,t){return S.dispatchCustomEvent(this._containerElem[0],"lovDropdownEvent",e,t)},C.prototype.destroy=function(){(this._itemTemplate||this._collectionTemplate)&&this._containerElem&&this._getTemplateEngineFunc().then(function(e){e.clean(this._containerElem[0])}.bind(this)),this._removeDataProviderEventListeners()},C.prototype.getElement=function(){return this._containerElem?this._containerElem[0]:null},C.prototype._createInnerDom=function(e){var t=e.idSuffix,i=document.createElement("div");i.setAttribute("data-oj-containerid",e.parentId),i.setAttribute("data-oj-context",""),i.setAttribute("id","lovDropdown_"+t),i.setAttribute("class","oj-listbox-drop oj-listbox-searchselect"+(this._fullScreenPopup?" oj-listbox-fullscreen":"")),i.style.display="none",i.setAttribute("role","presentation"),this._fullScreenPopup&&i.appendChild(this._filterInputText);var n=document.createElement("div");return n.setAttribute("class","oj-searchselect-results-placeholder"),i.appendChild(n),s(i)},C.prototype._createDropdownPositioningProxyElem=function(e){var t=e.idSuffix,i=document.createElement("div");i.style.visibility="hidden",i.style.position="absolute",i.style.overflow="hidden";var n=document.createElement("div");n.setAttribute("data-oj-containerid",e.parentId),n.setAttribute("data-oj-context",""),n.setAttribute("id","lovDropdownPositioningProxy_"+t),n.setAttribute("class","oj-listbox-drop oj-listbox-searchselect"),i.appendChild(n);var r=document.createElement("div");return r.setAttribute("class","oj-select-results"),n.appendChild(r),s(i)},C.prototype._defaultItemRenderer=function(e){var t,i=e.parentElement,n=this._itemTextRendererFunc({key:e.key,data:e.data,metadata:e.metadata});!1===e.leaf?(t=document.createElement("span"),s(t).text(n)):((t=document.createElement("oj-highlight-text")).setAttribute("text",n),t.setAttribute("match-text",this._collectionContext.searchText)),i.appendChild(t)},C.prototype._templateItemRenderer=function(e,t){var i=s.extend({},t);i.componentElement=this._templateContextComponentElement,i.searchText=this._collectionContext.searchText;var n=i.parentElement;if(e)for(var r=e.execute(i.componentElement,this._itemTemplate,i),o=0;o<r.length;o++)n.appendChild(r[o])},C.prototype.renderResults=function(e,t,i,n){var r,o,s=this._addBusyStateFunc("LovDropdown rendering results");this._latestFilterCriteria=t,this._clearSelection(),this._duringListViewInitialization=!0;var l=new Promise(function(e,t){r=e,o=t}),u=new Promise(function(t,r){l.then(function(){a.getContext(this._containerElem[0]).getBusyContext().whenReady().then(function(){u===this._lastRenderResultsPromise?this._configureResults(e,i,n).then(t,r):t()}.bind(this),r)}.bind(this),r)}.bind(this));this._lastRenderResultsPromise=u;var c=this._collectionContext;c.data=this._dataProvider,c.searchText=e,this._getThrottlePromiseFunc().then(function(){if(c.renderError){var e=c.renderError;this._clearContextRenderPromiseFunctions(c),e("LovDropdown.renderResults: rejecting earlier promise")}c.renderDone=r,c.renderError=o,this._dataProvider.setFilterCriterion(t),this._collectionRendererFunc(c)}.bind(this));var h=function(){u===this._lastRenderResultsPromise&&(this._duringListViewInitialization=!1),s()}.bind(this);return u.then(function(){h()},function(e){u===this._lastRenderResultsPromise&&d.warn("Select: LovDropdown.renderResults retPromise rejected: "+e),h()}.bind(this))},C.prototype.updateLabel=function(e,t){var i=this._resultsElem;if(i){if(!this._collectionTemplate){var n=i[0];e?(n.setAttribute("aria-labelledby",e),n.setAttribute("aria-label","")):t&&(n.setAttribute("aria-label",t),n.setAttribute("aria-labelledby",""))}}else this._updateLabelFunc=this.updateLabel.bind(this,e,t)},C.prototype._configureResults=function(e,t,i){var n=a.getContext(this._containerElem[0]).getBusyContext();return this._setCurrentFirstItem(null),this._focusinListener&&(this._containerElem[0].removeEventListener("focusin",this._focusinListener),this._focusListener=null),this._resultsCount=this._dataProvider.getFetchedDataCount()||{},null==this._resultsCount.count||0===this._resultsCount.count?(this._containerElem.addClass(this._NO_RESULTS_FOUND_CLASSNAME),Promise.resolve()):(this._containerElem.removeClass(this._NO_RESULTS_FOUND_CLASSNAME),i?null!=t?(this._setCollectionCurrentRow({rowKey:t}),this._setCollectionSelectedKeySet(t),n.whenReady()):this._fullScreenPopup?n.whenReady():this._fetchFirstResultForKeyboardFocus():null==e||""===e?(this._clearSelection(),this._fullScreenPopup?n.whenReady():this._fetchFirstResultForKeyboardFocus()):this._fetchFirstResult().then(function(e){if(null==e)return this._clearSelection(),n.whenReady();var t=e.key;return this._setCurrentFirstItem(e),this._setCollectionCurrentRow({rowKey:t}),this._setCollectionSelectedKeySet(t),n.whenReady()}.bind(this)))},C.prototype._fetchFirstResult=function(){return o.DataProviderFeatureChecker.isTreeDataProvider(this._dataProvider)?this._fetchFirstLeafData():this._fetchFirstFlatData()},C.prototype._fetchFirstFlatData=function(){var e=this._dataProvider.fetchByOffset({offset:0,size:1}),t=null,i=function(e){if(null!=e){var i=e.results;if(i.length>0){var n=i[0];t=this._createValueItemFromItem(n)}}return Promise.resolve(t)}.bind(this);return e.then(i)},C.prototype._fetchFirstLeafData=function(){var e={size:1},t=this,i=!1;return function n(r){var o=null,s=r.fetchFirst(e)[Symbol.asyncIterator]();return s.next().then(function e(a){var l=a.value.data,d=a.value.metadata;return function e(s){if(s<l.length&&!i){var a=l[s],u=d[s],c=r.getChildDataProvider(u.key);if(null!=c)return n(c).then(function(t){return o=t,e(s+1)});var h={data:a,metadata:u};o=t._createValueItemFromItem(h),i=!0}return Promise.resolve(o)}(0).then(function(){return a.done||i?Promise.resolve(o):s.next().then(e)})})}(this._dataProvider)},C.prototype._clearSelection=function(){this._setCollectionCurrentRow({rowKey:null}),this._setCollectionSelectedKeySet(null)},C.prototype._clearContextRenderPromiseFunctions=function(e){e.renderDone=null,e.renderError=null},C.prototype._defaultCollectionRenderer=function(e){var t,i=e.renderDone,n=e.renderError;if(this._resultsElem)t=this._resultsElem[0],a.getContext(t).getBusyContext().whenReady().then(function(){t.data=e.data,t.selected=e.selected,t.currentItem=e.currentRow.rowKey,this._clearContextRenderPromiseFunctions(e),i()}.bind(this),function(t){d.warn("Select: busyContext promise rejected before setting props on listView: "+t),this._clearContextRenderPromiseFunctions(e),n(t)}.bind(this));else{var r=s(e.parentElement).find(".oj-searchselect-results-placeholder")[0],l=e.idSuffix;(t=document.createElement("oj-list-view")).setAttribute("data-oj-internal",""),t.setAttribute("data-oj-binding-provider","none"),t.setAttribute("id","oj-searchselect-results-"+l),t.setAttribute("selection-mode","single"),t.setAttribute("class","oj-select-results oj-group-header-sm"),t.setAttribute("drill-mode","none"),t.setAttribute("gridlines.item","hidden");var u=document.createElement("template");u.setAttribute("slot","noData");var c=document.createElement("div");c.setAttribute("class","oj-searchselect-no-results-container"),u.content?u.content.appendChild(c):u.appendChild(c),t.appendChild(u),e.parentElement.replaceChild(t,r),this._resultsElem=s(t),this._resultsElem.on("click",S.killEvent),a.getContext(t).getBusyContext().whenReady().then(function(){t.addEventListener("ojItemAction",e.handleRowAction),t.addEventListener("currentItemChanged",function(t){e.currentRowKeyChangedListener(t.detail.value)}),e.data&&o.DataProviderFeatureChecker&&o.DataProviderFeatureChecker.isTreeDataProvider(e.data)&&(t.setProperty("item.focusable",function(e){return e.leaf}),t.setProperty("item.selectable",function(e){return e.leaf})),this._itemTemplate?this._getTemplateEngineFunc().then(function(n){t.setProperty("item.renderer",this._templateItemRenderer.bind(this,n)),this._clearContextRenderPromiseFunctions(e),i()}.bind(this),function(t){d.warn("Select: template item renderer template engine promise rejected: "+t),this._clearContextRenderPromiseFunctions(e),n(t)}.bind(this)):(t.setProperty("item.renderer",this._defaultItemRenderer.bind(this)),this._clearContextRenderPromiseFunctions(e),i())}.bind(this),function(t){d.warn("Select: creating default listView busyContext promise rejected: "+t),this._clearContextRenderPromiseFunctions(e),n(t)}.bind(this))}},C.prototype._templateCollectionRenderer=function(e){var t=e.renderDone,i=e.renderError;if(this._resultsElem){var n=this._collectionTemplateContext;n.data=e.data,n.searchText=e.searchText,n.selected=e.selected,this._clearContextRenderPromiseFunctions(e),t()}else{var r=s(e.parentElement),o=r.find(".oj-searchselect-results-placeholder")[0];this._getTemplateEngineFunc().then(function(i){this._templateEngine=i,this._collectionTemplateContext=this._createCollectionTemplateContext(i,e);for(var n=i.execute(this._templateContextComponentElement,this._collectionTemplate,this._collectionTemplateContext),s=0;s<n.length;s++)o.parentNode.insertBefore(n[s],o);o.parentNode.removeChild(o),this._resultsElem=r.find(".oj-select-results"),this._resultsElem.on("click",S.killEvent),this._clearContextRenderPromiseFunctions(e),t()}.bind(this),function(t){d.warn("Select: template collection renderer template engine promise rejected: "+t),this._clearContextRenderPromiseFunctions(e),i(t)}.bind(this))}},C.prototype._addDataProviderEventListeners=function(){var e=this._dataProvider;if(e){var t=this._handleDataProviderEvent.bind(this);this._savedDataProviderEH=t,e.addEventListener("mutate",t),e.addEventListener("refresh",t)}},C.prototype._removeDataProviderEventListeners=function(){var e=this._dataProvider,t=this._savedDataProviderEH;e&&t&&(e.removeEventListener("mutate",t),e.removeEventListener("refresh",t)),this._savedDataProviderEH=void 0},C.prototype._handleDataProviderEvent=function(e){var t=this._addBusyStateFunc("LovDropdown handling data provider event");a.getContext(this._containerElem[0]).getBusyContext().whenReady().then(function(){t()},function(e){d.warn("Select: LovDropdown.handleDataProviderEvent busyContext promise rejected: "+e),t()})},C.prototype.close=function(){this._lastRenderResultsPromise=null;var e=document.activeElement;l.isAncestor(this.getElement(),e)&&e.blur(),this._clearSelection(),this._focusinListener&&(this._containerElem[0].removeEventListener("focusin",this._focusinListener),this._focusListener=null);var t={};t[o.PopupService.OPTION.POPUP]=this._containerElem,o.PopupService.getInstance().close(t),this._containerElem.detach(),this._dispatchEvent("dropdownClosed")},C.prototype.open=function(){var e=this._containerElem;this._containerElem.removeClass(this._NO_RESULTS_FOUND_CLASSNAME),e[0]!==this._bodyElem.children().last()[0]&&e.appendTo(this._bodyElem);var t={};t[o.PopupService.EVENT.POPUP_CLOSE]=function(){this._dispatchEvent("closeDropdown",{trigger:"popupCloseEvent"})}.bind(this),t[o.PopupService.EVENT.POPUP_REMOVE]=this._surrogateRemoveHandler.bind(this),t[o.PopupService.EVENT.POPUP_AUTODISMISS]=this._clickAwayHandler.bind(this),t[o.PopupService.EVENT.POPUP_REFRESH]=function(){this._dispatchEvent("sizeDropdown"),this._bodyElem.append(this._dropdownPositioningProxyContainer),this._dispatchEvent("adjustDropdownPosition",{popupElem:e[0],positioningProxyElem:this._dropdownPositioningProxyContainer.children()[0]}),this._dropdownPositioningProxyContainer.detach()}.bind(this),t[o.PopupService.EVENT.POPUP_AFTER_OPEN]=function(e){var t=e.popup[0];this._dispatchEvent("sizeDropdown"),this._bodyElem.append(this._dropdownPositioningProxyContainer),this._dispatchEvent("adjustDropdownPosition",{popupElem:t,positioningProxyElem:this._dropdownPositioningProxyContainer.children()[0]}),this._dropdownPositioningProxyContainer.detach(),this._fullScreenPopup&&t.scrollIntoView()}.bind(this);var i={};i[o.PopupService.OPTION.POPUP]=e,i[o.PopupService.OPTION.EVENTS]=t,i[o.PopupService.OPTION.LAYER_SELECTORS]="oj-listbox-drop-layer",i[o.PopupService.OPTION.CUSTOM_ELEMENT]=!0,this._fullScreenPopup&&(i[o.PopupService.OPTION.MODALITY]=o.PopupService.MODALITY.MODAL),this._dispatchEvent("openPopup",{psOptions:i})},C.prototype._clickAwayHandler=function(e){var t=this._containerElem,i=s(e.target);if(!i.closest(t).length&&!i.closest("#"+s.escapeSelector(t.attr("data-oj-containerid"))).length){var n=t.closest(".oj-listbox-drop-layer");n.length>0&&i.closest(n).length>0||t.length>0&&this._dispatchEvent("closeDropdown",{trigger:"clickAway"})}},C.prototype._surrogateRemoveHandler=function(){this._containerElem&&this._containerElem.remove()},C.prototype._handleKeyDown=function(e){e.which===S.KEYS.TAB?this._dispatchEvent("tabOut"):e.which===S.KEYS.ESC&&this._dispatchEvent("closeDropdown",{trigger:"escKeyDown"})},C.prototype._handleCollectionSelectedItemChanged=function(e,t){if(!this._duringListViewInitialization&&!this._handlingCollectionFocusinOnce){var i=S.isValueItemForPlaceholder(e)?null:e;this._collectionContext.selectedItem=i,this._handleSelection(i,t)}},C.prototype._handleCollectionCurrentRowChanged=function(e){this._duringListViewInitialization||null==e||this._handlingCollectionFocusinOnce||(this._collectionContext.currentRow={rowIndex:e.rowIndex,rowKey:e.rowKey},this._handleCollectionCurrentRowKeyChanged(e.rowKey))},C.prototype._handleCollectionCurrentRowKeyChanged=function(e){this._duringListViewInitialization||null==e||this._handlingCollectionFocusinOnce||(this._collectionContext.currentRow.rowKey=e,this._setCollectionSelectedKeySet(e))},C.prototype._handleRowAction=function(e,t){var i=this._createValueItemFromItem(e.detail.context);this._handleSelection(i,e)},C.prototype._handleSelection=function(e,t){e&&this._dispatchEvent("handleSelection",{valueItem:e,event:t})},C.prototype._createCollectionTemplateContext=function(e,t){var i={};if(e){i.data=t.data,i.searchText=t.searchText,e.defineTrackableProperty(i,"selected"),e.defineTrackableProperty(i,"selectedItem",void 0,t.selectedItemChangedListener);var n={};e.defineTrackableProperty(n,"rowKey",void 0,t.currentRowKeyChangedListener),e.defineTrackableProperty(i,"currentRow",n,t.currentRowChangedListener),i.handleRowAction=t.handleRowAction}else d.error("JET Select: template engine not available when creating context for collectionTemplate");return i},C.prototype._createValueItemFromItem=function(e){return null==e.data||null==e.metadata?null:{key:e.metadata.key,data:e.data,metadata:e.metadata}},C.prototype._setCollectionSelectedKeySet=function(e){var t;t=null!=e?new h.KeySetImpl([e]):new h.KeySetImpl([]),this._collectionContext.selected=t,null!=this._collectionTemplateContext?this._collectionTemplateContext.selected=t:null==this._collectionTemplate&&this._resultsElem&&this._resultsElem[0].setProperty("selected",t)},C.prototype._setCollectionCurrentRow=function(e){this._collectionContext.currentRow={rowIndex:e.rowIndex,rowKey:e.rowKey},null!=this._collectionTemplateContext?(this._addListenerForRowKeyProperty(e),this._collectionTemplateContext.currentRow=e):null==this._collectionTemplate&&this._resultsElem&&this._resultsElem[0].setProperty("currentItem",e.rowKey)},C.prototype.getValueItemForSelection=function(){var e=this._collectionContext.currentRow.rowKey,t=this._currentFirstItem,i=this._collectionContext.selectedItem;if(null!=e){var n={};return n.key=e,t&&t.key===e&&(n.data=t.data,n.metadata=t.metadata),n}return i},C.prototype.getResultsCount=function(){return this._resultsCount},C.prototype._setCurrentFirstItem=function(e){this._currentFirstItem=e},C.prototype._addListenerForRowKeyProperty=function(e){var t=this._collectionContext,i=e.rowKey;this._templateEngine&&this._templateEngine.defineTrackableProperty(e,"rowKey",i,t.currentRowKeyChangedListener)},C.prototype._fetchFirstResultForKeyboardFocus=function(){var e=a.getContext(this._containerElem[0]).getBusyContext();return this._fetchFirstResult().then(function(t){return null!=t&&(this._focusinListener=this._handleCollectionFocusinOnce.bind(this,t),this._containerElem[0].addEventListener("focusin",this._focusinListener)),e.whenReady()}.bind(this))},C.prototype._handleCollectionFocusinOnce=function(e){if(this._containerElem[0].removeEventListener("focusin",this._focusinListener),this._focusinListener=null,!l.recentPointer()){var t=this._addBusyStateFunc("LovDropdown setting selected KeySet on focusin");this._handlingCollectionFocusinOnce=!0,this._setCollectionCurrentRow({rowKey:e.key}),this._setCollectionSelectedKeySet(e.key),a.getContext(this._containerElem[0]).getBusyContext().whenReady().then(function(){this._handlingCollectionFocusinOnce=!1,t()}.bind(this))}};
/**
   * @license
   * Copyright (c) 2018 2021, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */
var I=function e(t){function i(e,t){var i=new n(e,t);this[Symbol.asyncIterator]=function(){return i}}function n(e,t){this.next=function(){var i=e.next();return new Promise(function(e,n){i.then(function(i){var n=i.value;n.data&&(t.count+=n.data.length),t.done=i.done,e(i)},function(e){n(e)})})}}this._fetchedDataCount={count:0,done:!0},this.setFilterCriterion=function(e){var t,i,n=this._filterCriterion;if(this._filterCriterion=e,t=n,i=this._filterCriterion,!(t===i||!t&&!i||t&&i&&t.text===i.text)){var r=new y.DataProviderRefreshEvent;Object.defineProperty(r,"filterCriterionChanged",{value:!0}),this.dispatchEvent(r)}},this.getFetchedDataCount=function(){return this._fetchedDataCount},this.fetchFirst=function(e){if(t)return this._filterCriterion&&(e.filterCriterion=this._filterCriterion),this._fetchedDataCount={count:0,done:!0},new i(t.fetchFirst(e)[Symbol.asyncIterator](),this._fetchedDataCount);var n={};return n[Symbol.asyncIterator]=function(){return{next:function(){return Promise.resolve({value:{data:[],fetchParameters:e,metadata:[]},done:!0})}}},n},this.containsKeys=function(e){return t?t.containsKeys(e):Promise.resolve({containsParameters:e,results:new Set})},this.fetchByKeys=function(e){return t?t.fetchByKeys(e):Promise.resolve({fetchParameters:e,results:new Map})},this.fetchByOffset=function(e){return t?(this._filterCriterion&&(e.filterCriterion=this._filterCriterion),t.fetchByOffset(e)):Promise.resolve({done:!0,fetchParameters:e,results:[]})},this.isEmpty=function(){return t?t.isEmpty():"yes"},this.getTotalSize=function(){return t?t.getTotalSize():Promise.resolve(0)},this.addEventListener=function(e,i){t&&t.addEventListener(e,i)},this.removeEventListener=function(e,i){t&&t.removeEventListener(e,i)},this.dispatchEvent=function(e){return!t||t.dispatchEvent(e)},this.getCapability=function(e){return t?t.getCapability(e):null},t&&o.DataProviderFeatureChecker.isTreeDataProvider(t)&&(this.getChildDataProvider=function(){var i=t.getChildDataProvider.apply(t,arguments);return i&&(i=new e(i),this._filterCriterion&&i.setFilterCriterion(this._filterCriterion)),i}.bind(this))};
/**
   * @license
   * Copyright (c) 2018 2021, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */o.__registerWidget("oj.ojSelect2",s.oj.editableValue,{defaultElement:"<input>",widgetEventPrefix:"oj",_ALLOWED_INPUT_TYPES:["email","number","search","tel","text","url"],_OPTIONS_REQUIRING_REFRESH:new Set(["disabled","readOnly","placeholder","data","itemText"]),options:{placeholder:"",data:null,required:!1,virtualKeyboard:"search",readOnly:!1,valueItem:{key:null,data:null,metadata:null},itemText:"label",labelledBy:null},widget:function(){return s(this.OuterWrapper)},_ComponentCreate:function(){this._super(),this._cssOptionDefaults=_.parseJSONFromFontFamily("oj-searchselect-option-defaults")||{},this._fullScreenPopup="phone"===u.getDeviceRenderMode(),this._valueForPlaceholder=null,this._valueItemForPlaceholder={key:null,data:null,metadata:null},this._setupSelectResources()},_AfterCreate:function(){this._super(),this._initInputIdLabelForConnection(this._GetContentElement()[0],this.OuterWrapper.id,this.options.labelledBy);var e=this._getRootElement();this._focusable({element:e,applyHighlight:!1,afterToggle:this._handleAfterFocusToggle.bind(this,e)}),"none"===this.options.labelEdge&&this._updateLabel()},_IsTextFieldComponent:function(){return!0},_GetContentWrapper:function(){return this._lovMainField.getElement().querySelector(".oj-text-field-middle")},_handleAfterFocusToggle:function(e,t){"focusout"===t&&this._abstractLovBase.isDropdownOpen()&&e.classList.add("oj-focus")},_IsRequired:function(){return this.options.required},_labelledByUpdatedForInputComp:e.EditableValueUtils._labelledByUpdatedForInputComp,_initInputIdLabelForConnection:e.EditableValueUtils._initInputIdLabelForConnection,_linkLabelForInputComp:e.EditableValueUtils._linkLabelForInputComp,_AfterSetOptionRequired:e.EditableValueUtils._AfterSetOptionRequired,_GetTranslationsSectionName:function(){return"oj-ojSelectSingle"},_getTemplateSlot:function(e){var t=g.CustomElementUtils.getSlotMap(this.OuterWrapper)[e];return t&&t[0]&&"TEMPLATE"===t[0].tagName?t[0]:null},_setupSelectResources:function(e){this._loadingIndicatorCount=0;for(var t=this.OuterWrapper,i=t.childNodes,n=[],r=0;r<i.length;r++)n.push(i[r]);var o=this.options;this._wrapDataProviderIfNeeded(o.data),this._addDataProviderEventListeners(),this._SetInputType(this._ALLOWED_INPUT_TYPES);var a=this,l=function(){return a.getTranslatedString.apply(a,arguments)},d=function(e){return S.addBusyState(t,e)},u=t.getAttribute("id");u||(u="oj-selectsingle-"+S.nextUid(),t.setAttribute("id",u));var c=u;this._idSuffix=u;var h=!o.disabled;this._lovEnabled=h;var p=o.readOnly||!1,_=this.element;_.prop("disabled",!(h&&!p));var v=this._cssOptionDefaults.showIndicatorDelay;v=parseInt(v,10),v=isNaN(v)?250:v,this._showIndicatorDelay=v;var f=_.attr("type");this._resolveValueItemLater=!1;var m="oj-searchselect";this._className=m,this._initContainer(m,c,p);var y=new P({className:m,ariaLabel:t.getAttribute("aria-label"),ariaControls:t.getAttribute("aria-controls"),idSuffix:c,inputType:f,enabled:h,readOnly:p,placeholder:o.placeholder,addBusyStateFunc:d,forceReadOnly:this._fullScreenPopup,endContent:this._createMainFieldEndContent(h,p),cachedMainFieldInputElement:e,createOrUpdateReadonlyDivFunc:this._createOrUpdateReadonlyDiv.bind(this)});this._lovMainField=y,this._initLovMainField(y);var b=y.getElement();t.appendChild(b);var g=this._createFilterInputText(m,c);this._fullScreenPopup||(g.style.visibility="hidden",t.appendChild(g)),this._filterInputText=g;var E=new C;this._initLovDropdownFunc=function(e){var i=function(t){this._fullScreenPopup&&g.setAttribute("aria-controls",t.id),e&&e()}.bind(this);this._initLovDropdown(c,f,u,l,d,i);var n=E.getElement();t.appendChild(n),n.addEventListener("lovDropdownEvent",this._handleLovDropdownEvent.bind(this)),s(y.getInputElem()).attr("aria-owns",n.id)}.bind(this),this._lovDropdown=E;var w=new F({className:m,dataProvider:this._wrappedDataProvider,containerElem:t,fullScreenPopup:this._fullScreenPopup,idSuffix:c,lovMainField:y,filterInputText:g,lovDropdown:E,liveRegion:this._liveRegion,enabled:h,readOnly:p,value:o.value,getTranslatedStringFunc:l,addBusyStateFunc:d,showMainFieldFunc:this._showMainField.bind(this),setFilterFieldTextFunc:this._setFilterFieldText.bind(this),setUiLoadingStateFunc:this._setUiLoadingState.bind(this)});this._abstractLovBase=w,_.attr("tabindex","-1").hide().attr("aria-hidden",!0),w.hasData()&&this._initSelectedValue(o.valueItem),this._refreshRequired(o.required),this._resolveValueItemLater=this._mergeValueAndValueItem(o.value,o.valueItem),this._updateLabel();for(var I=0;I<n.length;I++)t.appendChild(n[I])},_releaseSelectResources:function(e){for(var t=this._loadingIndicatorCount;t>=0;t--)this._setUiLoadingState("stop");this._loadingIndicatorCount=0,this._savedLoadingIndicator=!1,this._deferredSetDisplayValue=null,this._clearMainFieldFocusHandlerTimer(),s(this._filterInputText).remove(),e&&(s(this._lovMainField.getInputElem()).detach(),this._cleanUpMainFieldInputElement(),s(this._lovMainField.getInputElem()).off(this._lovMainFieldInputEventListeners)),s(this._lovMainField.getElement()).remove(),s(this._liveRegion).remove(),this._abstractLovBase.destroy(),this._lovDropdown.getElement()&&(s(this._lovDropdown.getElement()).remove(),this._lovDropdown.destroy());var i=this.OuterWrapper,n=i.classList;n.remove(this._className),n.remove("oj-form-control"),n.remove("oj-component"),n.remove("oj-read-only"),n.remove("oj-enabled"),n.remove("oj-disabled"),s(i).off("change","."+this._className+"-input",S.stopEventPropagation).off(this._containerEventListeners),this._containerEventListeners=null,this.element.removeAttr("aria-hidden tabindex").show(),this._removeDataProviderEventListeners(),this._wrappedDataProvider=null,this._liveRegion=null,this._abstractLovBase=null,this._lovMainField=null,this._filterInputText=null,this._lovDropdown=null},_cleanUpMainFieldInputElement:function(){var e=this._lovMainField.getInputElem();if(o.AgentUtils.getAgentInfo().browser===o.AgentUtils.BROWSER.IE)e.removeAttribute("readonly"),e.removeAttribute("role"),e.removeAttribute("type"),e.removeAttribute("aria-controls"),e.removeAttribute("aria-expanded"),e.removeAttribute("aria-label"),e.removeAttribute("aria-labelledby");else for(;e.hasAttributes();){var t=e.attributes[0].name;e.removeAttribute(t)}e.value=""},_updateLabel:function(){var e,t,i=this.options,n=this._lovMainField,r=this._lovDropdown,o=this._filterInputText;i.labelledBy&&(e=i.labelledBy);var s=this.OuterWrapper.getAttribute("aria-label");s&&(t=s),r.updateLabel(e,t),n.updateLabel(e,t),e?(o.setAttribute("labelled-by",e),o.setAttribute("aria-label","")):t&&(o.setAttribute("aria-label",t),o.setAttribute("labelled-by","")),this._fullScreenPopup&&(i.labelHint?(o.setAttribute("label-hint",i.labelHint),o.setAttribute("label-edge","inside"),o.setAttribute("labelled-by","")):o.setAttribute("label-hint",""))},_initContainer:function(e,t,i){var n=this.OuterWrapper,r=s(n),o=n.classList;o.add(e),o.add("oj-form-control"),o.add("oj-component"),i?o.add("oj-read-only"):o.add(this._lovEnabled?"oj-enabled":"oj-disabled"),this._fullScreenPopup?o.add("oj-searchselect-mobile"):o.remove("oj-searchselect-mobile"),this._toggleNoValueStyleClass();var a=document.createElement("div");a.setAttribute("id","oj-listbox-live-"+t),a.setAttribute("class","oj-helper-hidden-accessible oj-listbox-liveregion"),a.setAttribute("aria-live","polite"),n.appendChild(a),r.on("change","."+e+"-input",S.stopEventPropagation),this._containerEventListeners={click:S.killEvent,keydown:this._handleContainerKeyDown.bind(this),mouseup:function(){r.removeClass("oj-active")}},r.on(this._containerEventListeners),this._liveRegion=a},_toggleNoValueStyleClass:function(){var e=this.OuterWrapper.classList;S.isValueForPlaceholder(this.options.value)?e.add("oj-searchselect-no-value"):e.remove("oj-searchselect-no-value")},_setFilterFieldText:function(e){this._ignoreFilterFieldRawValueChanged=!0,this._filterInputText.value=e,this._fullScreenPopup&&(this._lovDropdown.getElement().parentElement||s(this._filterInputText).find("oj-label").remove()),this._filterInputText.refresh(),this._ignoreFilterFieldRawValueChanged=!1},_showFilterField:function(e){if(!this._fullScreenPopup){var t=this._filterInputText;if("hidden"===t.style.visibility){var i=this._lovMainField,n=i.getInputElem();e||(this._setFilterFieldText(n.value),S.copyAttribute(n,"aria-describedby",t,"described-by"));var r=this._getFilterInputElem();r&&(r.setAttribute("role","combobox"),e||(S.copyAttribute(n,"aria-required",r,"aria-required"),S.copyAttribute(n,"aria-invalid",r,"aria-invalid"))),i.getInputElem().style.visibility="hidden",t.style.visibility="",this.OuterWrapper.appendChild(t)}if(!e)if(o.AgentUtils.getAgentInfo().browser===o.AgentUtils.BROWSER.IE){var s=S.addBusyState(this.OuterWrapper,"Select transferring focus to filter field");setTimeout(function(){t.focus(),s()},0)}else t.focus()}},_showMainField:function(){if(!this._fullScreenPopup){var e=this._filterInputText;if("hidden"!==e.style.visibility){var t=this._lovMainField.getInputElem();t.setSelectionRange(0,0),t.style.visibility="",e.style.visibility="hidden"}}},_isFilterInputTextCleared:function(){var e=this._filterInputText.rawValue;return null==e||""===e},_handleContainerKeyDown:function(e){if(this._lovEnabled&&!this.options.readOnly&&!S.isControlOrFunctionKey(e))if(e.which!==S.KEYS.PAGE_UP&&e.which!==S.KEYS.PAGE_DOWN){var t,i=this._abstractLovBase,n=this._lovDropdown;switch(e.which){case S.KEYS.UP:case S.KEYS.DOWN:if(i.isDropdownOpen())if(c.focusFirstTabStop(n.getElement()),this.OuterWrapper.classList.add("oj-focus"),o.AgentUtils.getAgentInfo().browser===o.AgentUtils.BROWSER.IE){var r=S.addBusyState(this.OuterWrapper,"Select showing filter field while arrowing into dropdown");setTimeout(function(){this._showFilterField(!0),r()}.bind(this),0)}else this._showFilterField(!0);else this._openDropdown();e.preventDefault();break;case S.KEYS.ENTER:e.preventDefault(),this._userHasTypedFilterText=!1,!this._fullScreenPopup&&this._isFilterInputTextCleared()?this._handleSelection(this._valueItemForPlaceholder):!this._fullScreenPopup&&i.isDropdownOpen()&&null!=(t=n.getValueItemForSelection())&&this._fetchDataAndSelect(t,e);break;case S.KEYS.TAB:if(this._userHasTypedFilterText=!1,!this._fullScreenPopup){if(e.shiftKey)for(var s=this._filterInputText,a=s.parentNode;a.firstChild!==s;)a.appendChild(a.firstChild);this._isFilterInputTextCleared()?this._handleSelection(this._valueItemForPlaceholder):i.isDropdownOpen()&&null!=(t=n.getValueItemForSelection())&&this._fetchDataAndSelect(t,e)}this._closeDropdown();break;case S.KEYS.ESC:i.isDropdownOpen()&&(i.cancel(),e.preventDefault())}}else e.preventDefault()},_handleContainerMouseDown:function(e){var t=this._abstractLovBase;this._lovEnabled||e.preventDefault();var i=this.OuterWrapper,n=s(i),r=0===e.button,o=!1,a=this._lovMainField.getInputElem();if(r&&!this.options.readOnly){if(this._fullScreenPopup){var d=i.querySelector(".oj-searchselect-clear-value");if(d&&l.isAncestorOrSelf(d,e.target))return}if(this._lovEnabled)if(t.isDropdownOpen()){if(!this._fullScreenPopup&&t.isDropdownOpen()){var u=this._filterInputText.querySelector(".oj-searchselect-arrow");l.isAncestorOrSelf(u,e.target)&&this._closeDropdown()}}else{var c=this._lovMainField.getElement().querySelector(".oj-searchselect-arrow"),h=l.isAncestorOrSelf(c,e.target);!this._fullScreenPopup&&h&&a.setSelectionRange(1e6,1e6),this._openDropdown(),this._fullScreenPopup&&e.preventDefault()}}if(n.addClass("oj-active"),r){if(!this._fullScreenPopup&&this._lovEnabled){var p=this._getFilterInputElem();"hidden"===this._filterInputText.style.visibility?(e.target!==p&&e.target!==a||(o=!0),a.focus()):this.options.readOnly||(e.target===p&&(o=!0),this._showFilterField())}o||e.preventDefault()}},_handleLovDropdownEvent:function(e){var t=e.detail,i=this._abstractLovBase;switch(t.subtype){case"closeDropdown":"escKeyDown"===t.trigger?this._filterInputText.focus():"clickAway"===t.trigger&&(this._userHasTypedFilterText=!1,this._showMainField(),this.OuterWrapper.classList.remove("oj-focus")),this._closeDropdown();break;case"tabOut":if(this._userHasTypedFilterText=!1,this._filterInputText.focus(),!this._fullScreenPopup){var n=this._lovDropdown.getValueItemForSelection();null!=n&&this._fetchDataAndSelect(n,e)}break;case"sizeDropdown":i.sizeDropdown();break;case"adjustDropdownPosition":var r=i.getDropdownPosition();if(this._fullScreenPopup)s(t.popupElem).position(r);else{var a=t.positioningProxyElem,l=s(a).find(".oj-select-results")[0],d=s(t.popupElem),u=d.find(".oj-select-results");a.style.width=d.outerWidth()+"px",l.style.height=u.css("max-height"),s(a).position(r)}break;case"openPopup":var c=t.psOptions;c[o.PopupService.OPTION.LAUNCHER]=this.element,c[o.PopupService.OPTION.POSITION]=i.getDropdownPosition(),o.PopupService.getInstance().open(c);break;case"handleSelection":this._userHasTypedFilterText=!1,this._handleSelection(t.valueItem,t.event);break;case"dropdownClosed":this._searchTextOnKeyDown=void 0}},_fetchDataAndSelect:function(e,t){if(null!=e.data)this._handleSelection(e,t);else{var i=[e.key],n=function(){this._handleSelection(this._valueItemForPlaceholder)}.bind(this),r=function(i){if(i.data.length>0){var r={};r.key=e.key,r.data=i.data[0],r.metadata=i.metadata[0],this._handleSelection(r,t)}else n()}.bind(this);this._fetchByKeysFromDataProvider(i).then(r,n)}},_handleSelection:function(e,t){var i=S.isValueItemForPlaceholder(e)?this._valueItemForPlaceholder:e;if(this._handleUserSelectedValueItem(i,t,void 0),!t||"blur"!==t.type){var n=this._lovMainField.getInputElem();this._fullScreenPopup?n.focus():(S.isValueItemForPlaceholder(i)&&(n.value=""),this._setFilterFieldText(n.value),this._showFilterField())}this._closeDropdown()},_closeDropdown:function(){var e=this._lovDropdown.getElement();if(null!=e){var t=document.activeElement;t&&l.isAncestor(e,t)&&t.blur(),this._abstractLovBase.closeDropdown()}},_handleUserSelectedValueItem:function(e,t,i){var n=this.options.value,r=this._abstractLovBase;this._cachedFetchByKeys&&(this._valueHasChanged=!0,this._setUiLoadingState("stop")),this._resolveValueItemLater=!0;var o=null;S.isValueItemForPlaceholder(e)||(o=e.key),r.setValue(o),this._userSelectedValueItem=e;var s=this._SetValue(o,t,{doValueChangeCheck:!1,_context:i}),a=function(t){this._userSelectedValueItem=null,t&&this._fireValueActionEvent(e,n),this._resolveFetchDataAndSelectPromise&&(this._resolveFetchDataAndSelectPromise(),this._resolveFetchDataAndSelectPromise=null)}.bind(this);s instanceof Promise?s.then(a,function(){a(!1)}):a(s)},_createMainFieldEndContent:function(e,t){var i=document.createElement("span");i.setAttribute("class","oj-text-field-end");var n=this._createDropdownIcon(e,t);if(i.appendChild(n),this._fullScreenPopup){var r=this._createClearValueIcon();i.appendChild(r)}return i},_createDropdownIcon:function(e,t){var i=this._className,n=document.createElement("a"),r=i+"-arrow "+i+"-open-icon "+i+"-icon oj-component-icon oj-clickable-icon-nocontext";return t||e||(r+=" oj-disabled"),n.setAttribute("class",r),n.setAttribute("role","presentation"),n},_createClearValueIcon:function(){var e=this._className,t=document.createElement("a"),i=e+"-clear-value "+e+"-clear-value-icon "+e+"-icon oj-component-icon oj-clickable-icon-nocontext";t.setAttribute("class",i),t.setAttribute("role","button");var n=this.getTranslatedString("labelAccClearValue");return t.setAttribute("aria-label",n),t.addEventListener("click",function(){this._handleSelection(this._valueItemForPlaceholder)}.bind(this)),t},_initLovMainField:function(e){this._lovMainFieldInputEventListeners={focus:function(e){if(S.killEvent(e),!this._fullScreenPopup&&!this.options.readOnly){this._clearMainFieldFocusHandlerTimer();var t=S.addBusyState(this.OuterWrapper,"Select showing filter field after focusing main field");this._mainFieldFocusHandlerTimer=b.getTimer(0),this._mainFieldFocusHandlerTimer.getPromise().then(function(e){e&&(this._mainFieldFocusHandlerTimer=null,this._showFilterField(),this._transferSelectionRangeToFilterField()),t()}.bind(this))}}.bind(this)},s(e.getInputElem()).on(this._lovMainFieldInputEventListeners),s(e.getElement()).on({mousedown:this._handleContainerMouseDown.bind(this)})},_clearMainFieldFocusHandlerTimer:function(){this._mainFieldFocusHandlerTimer&&(this._mainFieldFocusHandlerTimer.clear(),this._mainFieldFocusHandlerTimer=null)},_transferSelectionRangeToFilterField:function(){var e=this._lovMainField.getInputElem(),t=this._getFilterInputElem();t&&t.setSelectionRange(e.selectionStart,e.selectionEnd,e.selectionDirection)},_getFilterInputElem:function(){var e=s(this._filterInputText).find("input");return e.length>0?e[0]:null},_createFilterInputText:function(e,t){var i=this.OuterWrapper.getAttribute("aria-label"),n=this.OuterWrapper.getAttribute("aria-controls"),r=this.options,o=document.createElement("oj-input-text");if(o.setAttribute("display-options.messages","none"),o.setAttribute("user-assistance-density","compact"),o.setAttribute("id",e+"-filter-"+t),o.setAttribute("class",e+"-filter"),o.setAttribute("clear-icon",this._fullScreenPopup?"always":"never"),o.setAttribute("autocomplete","off"),o.setAttribute("aria-autocomplete","list"),o.setAttribute("data-oj-internal",""),o.setAttribute("data-oj-context",""),o.setAttribute("data-oj-binding-provider","none"),r.placeholder&&o.setAttribute("placeholder",r.placeholder),o.setAttribute("disabled",r.disabled),i&&o.setAttribute("aria-label",i),!this._fullScreenPopup&&n&&o.setAttribute("aria-controls",n),o.setAttribute("virtual-keyboard",r.virtualKeyboard),this._fullScreenPopup){var a=this.getTranslatedString("cancel"),d=document.createElement("span");d.setAttribute("id","cancelButton_"+this._idSuffix),d.setAttribute("slot","start"),d.setAttribute("class",e+"-back-button"),d.setAttribute("aria-label",a),d.addEventListener("click",function(){this._lovMainField.getInputElem().focus(),this._abstractLovBase.cancel()}.bind(this)),o.appendChild(d);var u=document.createElement("span");u.setAttribute("class",e+"-back-icon "+e+"-icon oj-component-icon oj-clickable-icon-nocontext"),d.appendChild(u)}else{var c=document.createElement("a");c.setAttribute("class",e+"-arrow "+e+"-open-icon "+e+"-icon oj-component-icon oj-clickable-icon-nocontext"),c.setAttribute("slot","end"),o.appendChild(c)}var h=s(this.OuterWrapper);return o.addEventListener("rawValueChanged",function(e){this._ignoreFilterFieldRawValueChanged||(this._userHasTypedFilterText=!0,this._updateResults(e))}.bind(this)),o.addEventListener("focus",function(){h.addClass("oj-focus")}),o.addEventListener("blur",function(e){h.removeClass("oj-focus"),this._fullScreenPopup||e.relatedTarget&&l.isAncestor(this._lovDropdown.getElement(),e.relatedTarget)||this._showMainField()}.bind(this)),this._fullScreenPopup||o.addEventListener("mousedown",this._handleContainerMouseDown.bind(this)),o},_initLovDropdown:function(e,t,i,n,r,o){this._lovDropdown.init({dataProvider:this._wrappedDataProvider,className:"oj-select",parentId:i,idSuffix:e,fullScreenPopup:this._fullScreenPopup,inputType:t,bodyElem:s(this.OuterWrapper).closest("body")[0],itemTemplate:this._getTemplateSlot("itemTemplate"),collectionTemplate:this._getTemplateSlot("collectionTemplate"),getTemplateEngineFunc:this._loadTemplateEngine.bind(this),templateContextComponentElement:this.OuterWrapper,getTranslatedStringFunc:n,addBusyStateFunc:r,itemTextRendererFunc:this._itemTextRenderer.bind(this),filterInputText:this._filterInputText,afterDropdownInitFunc:o,getThrottlePromiseFunc:this._GetThrottlePromise.bind(this)})},_openDropdown:function(){if(this._initLovDropdownFunc){var e=this._initLovDropdownFunc;this._initLovDropdownFunc=null,e(function(){this._abstractLovBase&&this._abstractLovBase.openDropdown()}.bind(this))}else this._abstractLovBase.openDropdown()},_updateResults:function(e){if(this._initLovDropdownFunc){var t=this._initLovDropdownFunc;this._initLovDropdownFunc=null,t(function(){this._abstractLovBase&&this._abstractLovBase.updateResults(e)}.bind(this))}else this._abstractLovBase.updateResults(e)},_loadTemplateEngine:function(){if(!this._templateEngine){var e=S.addBusyState(this.OuterWrapper,"Select loading template engine");return new Promise(function(t,i){u.__getTemplateEngine().then(function(i){this._templateEngine=i,t(i),e()}.bind(this),function(t){i(new Error("Error loading template engine: "+t)),e()})}.bind(this))}return Promise.resolve(this._templateEngine)},_refreshRequired:e.EditableValueUtils._refreshRequired,_createOrUpdateReadonlyDiv:e.EditableValueUtils._createOrUpdateReadonlyDiv,_AriaRequiredUnsupported:function(){return!1},refresh:function(){var e=this._lovMainField.getInputElem();this._bSuperRefreshing=!0,this._super(),this._bSuperRefreshing=!1,this._releaseSelectResources(!0),this._setupSelectResources(e),this._initComponentMessaging(),this._deferredSetDisplayValue&&this._deferredSetDisplayValue()},_SetupResources:function(){this._super(),this._bReleasedResources&&(this._bReleasedResources=!1,this._setupSelectResources(),this._initComponentMessaging())},_ReleaseResources:function(){this._super(),this._bReleasedResources=!0,this._releaseSelectResources()},_setOptions:function(e,t){var i;this._processSetOptions||(this._processSetOptions=[]),this._processSetOptions.push({});for(var n=!1,r=e.hasOwnProperty("data"),o=e.hasOwnProperty("value"),s=e.hasOwnProperty("valueItem"),l=!1,d=Object.keys(e),u=0;u<d.length;u++)if(this._OPTIONS_REQUIRING_REFRESH.has(d[u])){l=!0;break}l&&(o?(this._deferSettingValue=!0,i=S.addBusyState(this.OuterWrapper,"Defer setting value")):r&&!s&&(n=this._valueItemSetInternally));var c=!1;!this._fullScreenPopup&&this._lovEnabled&&"hidden"!==this._filterInputText.style.visibility&&(c=!0);try{this._super(e,t);var h=this._processSetOptions.pop();h.forRefresh&&h.forRefresh(),i&&(this._deferSettingValue=!1),h.value?h.value():n&&this._setOption("value",this.options.value),c&&"hidden"===this._filterInputText.style.visibility&&a.getContext(this._filterInputText).getBusyContext().whenReady().then(function(){this._showFilterField()}.bind(this))}finally{i&&i()}},_setOption:function(e,t,i){var n,r=this._abstractLovBase;if(this._super(e,t,i),this._processSetOptions&&this._processSetOptions.length>0&&(n=this._processSetOptions[this._processSetOptions.length-1]),"valueItem"===e)this._valueItemSetInternally=!1,this._syncValueWithValueItem(t,this.options.value);else if("value"===e){var o=function(){r.setValue(t),S.isValueForPlaceholder(t)?this._setValueItem(this._valueItemForPlaceholder):this._updateValueItem(t),this._SetDisplayValue()}.bind(this);n?n.value=o:o()}else if(this._OPTIONS_REQUIRING_REFRESH.has(e)){var s=function(){this.refresh()}.bind(this);n?n.forRefresh=s:s()}else if("labelledBy"===e){if(this.options.labelledBy){var a=this._GetContentElement()[0].id;this._labelledByUpdatedForInputComp(this.options.labelledBy,a)}this._updateLabel()}},_AfterSetOption:function(e,t){switch(this._superApply(arguments),e){case"required":this._AfterSetOptionRequired(e);break;case"virtualKeyboard":this._SetInputType(this._ALLOWED_INPUT_TYPES),this.refresh();break;case"labelHint":case"labelEdge":this._updateLabel()}},_AfterSetOptionValue:function(e,t){this._superApply(arguments),"value"===e&&this._toggleNoValueStyleClass()},_NotifyDetached:function(){this._superApply(arguments),this._abstractLovBase.closeDropdown()},_NotifyHidden:function(){this._superApply(arguments),this._abstractLovBase.closeDropdown()},_VerifyConnectedForSetup:function(){return!0},_SetInputType:e.EditableValueUtils._SetInputType,_SetDisplayValue:function(e){this._deferSettingValue||(this._bSuperRefreshing?this._deferredSetDisplayValue=function(){this._deferredSetDisplayValue=null,this._SetDisplayValue(e)}.bind(this):(this._applyValueItem(this.options.valueItem)||this._initSelectedValue(),this._resolveValueItemLater=!1))},validate:function(){this._isInValidate=!0;var e=s(this._lovMainField.getInputElem()).val(),t=this._SetValue(e,null,this._VALIDATE_METHOD_OPTIONS);return t=t instanceof Promise?t.then(function(e){return Promise.resolve(e?"valid":"invalid")}):Promise.resolve(t?"valid":"invalid"),this._isInValidate=!1,t},_SetValue:function(e,t,i){return e===this._GetDisplayValue()&&void 0===(e=this._isInValidate&&""===e&&!this.isValid()?null:this.options.value)&&(e=null),this._super(e,t,i)},_NotifyContextMenuGesture:function(e,t,i){var n=this._GetMessagingLauncherElement();this._OpenContextMenu(t,i,{launcher:n})},_GetContentElement:function(){return this._lovMainField?s(this._lovMainField.getInputElem()):this.element},_GetDefaultStyleClass:function(){return"oj-select"},_isDataProvider:function(e){return!(!e||!o.DataProviderFeatureChecker)&&o.DataProviderFeatureChecker.isDataProvider(e)},_isTreeDataProvider:function(e){return!(!e||!o.DataProviderFeatureChecker)&&o.DataProviderFeatureChecker.isTreeDataProvider(e)},_wrapDataProviderIfNeeded:function(e){if(this._isDataProvider(e)){var t=e;this._isTreeDataProvider(e)?e instanceof m||(t=new m(e)):(e instanceof f||(t=new f(e)),t=new v(t)),t=new I(t),this._wrappedDataProvider=t}else this._wrappedDataProvider=new I(null)},_addDataProviderEventListeners:function(){var e=this._wrappedDataProvider;if(e){this._removeDataProviderEventListeners();var t=this._handleDataProviderEvent.bind(this);this._savedDataProviderEH=t,e.addEventListener("mutate",t),e.addEventListener("refresh",t)}},_removeDataProviderEventListeners:function(){var e=this._wrappedDataProvider,t=this._savedDataProviderEH;e&&t&&(e.removeEventListener("mutate",t),e.removeEventListener("refresh",t),this._savedDataProviderEH=void 0)},_handleDataProviderEvent:function(e){if(!e.filterCriterionChanged){var t=this.options.value;"mutate"===e.type&&null!=e.detail.remove&&e.detail.remove.keys.forEach(function(e){o.Object.compareValues(e,t)&&(t=this._valueForPlaceholder,d.warn("Select: selected value removed from data provider"))}.bind(this)),this._setOption("value",t),this._abstractLovBase.handleDataProviderEvent(e)}},_mergeValueAndValueItem:function(e,t){var i=!1;return S.isValueForPlaceholder(e)?t&&!this._deferSettingValue&&this._syncValueWithValueItem(t,e):t&&(i=!o.Object.compareValues(e,t.key)),i},_syncValueWithValueItem:function(e,t){var i,n=this._abstractLovBase;if(i=S.isValueItemForPlaceholder(e)?S.isValueForPlaceholder(t)?t:this._valueForPlaceholder:e?e.key:null,!o.Object.compareValues(i,t)){var r={doValueChangeCheck:!1,_context:{internalSet:!0,writeback:!0}};this.option("value",i,r),n.setValue(i),this._AfterSetOptionValue("value",r)}},_initSelectedValue:function(e){if(!this._applyValueItem(e)){var t=S.isValueItemForPlaceholder(e)?this.options.value:e.key;!S.isValueForPlaceholder(t)&&this._deferSettingValue||this._initSelectionHelper(t,this._updateSelectedOption.bind(this))}},_applyValueItem:function(e){return!this._resolveValueItemLater&&!S.isValueItemForPlaceholder(e)&&(this._updateInputElemValue(e),!0)},_updateSelectedOption:function(e){this._updateInputElemValue(e),this._setValueItem(e)},_setValueItem:function(e){this._valueItemSetInternally=!0;var t=e;e&&!S.isValueItemForPlaceholder(e)&&(t=S.createValueItem(e.key,e.data,e.metadata)),this.option("valueItem",t,{_context:{internalSet:!0,changed:!0,writeback:!0}})},_updateValueItem:function(e){this._initSelectionHelper(e,function(e){this._setValueItem(e),this._updateSelectedOption(e)}.bind(this))},_updateInputElemValue:function(e){var t=s(this._lovMainField.getInputElem());this._selectedValueItem=e;var i=null;if(e&&e.data){var n=this._itemTextRenderer(e),r=t.val();void 0!==n&&r!==n&&(i=n)}else i="";if(null!==i){if(t.val(i),this.options.readOnly){var o=this._getReadonlyDiv();o&&(o.textContent=i)}(!this._fullScreenPopup&&"hidden"!==this._filterInputText.style.visibility||this._fullScreenPopup&&this._abstractLovBase.isDropdownOpen())&&!this._userHasTypedFilterText&&this._setFilterFieldText(i)}},_itemTextRenderer:function(e){var t;if(e&&e.data){var i=this.options.itemText;t="string"==typeof i?e.data[i]:i(e)}return t},_initSelectionHelper:function(e,t){if(S.isValueForPlaceholder(e))t(this._valueItemForPlaceholder);else if(this._abstractLovBase.hasData())if(this._userSelectedValueItem){var i=this._userSelectedValueItem;this._initSelectionFetchByKey({data:[i.data],metadata:[i.metadata]},e,t)}else this.options.data?(this._loadingAwaitingData&&(this._loadingAwaitingData=!1,this._setUiLoadingState("stop")),this._fetchByKeysFromDataProvider([e]).then(function(i){this._bReleasedResources||this._initSelectionFetchByKey(i,e,t)}.bind(this),function(){this._bReleasedResources||this._initSelectionFetchByKey(null,e,t)}.bind(this))):this._loadingAwaitingData||(this._loadingAwaitingData=!0,this._setUiLoadingState("start"))},_initSelectionFetchByKey:function(e,t,i){if(o.Object.compareValues(t,this.options.value)&&!this._valueHasChanged){var n=null,r=null;e&&e.data&&e.data.length>0?(n=e.data[0],r=e.metadata[0]):d.warn("SelectSingle: could not fetch data for selected value: "+t),i(S.createValueItem(t,n,r)),this._valueHasChanged=void 0}},_fetchByKeysFromDataProvider:function(e){var t;if(this._cachedFetchByKeys&&this._cachedFetchByKeys.promise&&o.Object.compareValues(e,this._cachedFetchByKeys.key))t=this._cachedFetchByKeys.promise;else{var i=S.addBusyState(this.OuterWrapper,"fetching selected data"),n=!1;"init"===this._abstractLovBase.getFetchType()&&(this._abstractLovBase.isDropdownOpen()||(n=!0,this._setUiLoadingState("start"))),t=new Promise(function(t,i){this._wrappedDataProvider.fetchByKeys({keys:new Set(e)}).then(function(e){var i=[],n=[];e.results.forEach(function(e){i.push(e.data),n.push(e.metadata)}),t({data:i,metadata:n})},function(e){i(e)})}.bind(this)),this._cachedFetchByKeys={key:e,promise:t};var r=function(){this._bReleasedResources||(this._cachedFetchByKeys=void 0,n&&this._setUiLoadingState("stop")),i()}.bind(this);t.then(function(){r()},function(e){d.warn("Select: fetchByKeys promise was rejected: "+e),r()})}return t},_setUiLoadingState:function(e){"start"===e?(this._loadingIndicatorTimer&&this._loadingIndicatorTimer.clear(),this._loadingIndicatorTimer=b.getTimer(this._showIndicatorDelay),this._loadingIndicatorTimer.getPromise().then(function(e){e&&this._addLoadingIndicator()}.bind(this))):"stop"===e&&(this._loadingIndicatorTimer&&(this._loadingIndicatorTimer.clear(),this._loadingIndicatorTimer=null),this._removeLoadingIndicator())},_addLoadingIndicator:function(){this._loadingIndicatorCount+=1,this._savedLoadingIndicator||(this._SetLoading(),this._savedLoadingIndicator=!0)},_removeLoadingIndicator:function(){this._loadingIndicatorCount>0&&(this._loadingIndicatorCount-=1),0===this._loadingIndicatorCount&&this._savedLoadingIndicator&&(this._ClearLoading(),this._savedLoadingIndicator=!1)},_fireValueActionEvent:function(e,t){var i={value:e.key,itemContext:e,previousValue:t},n=new CustomEvent("ojValueAction",{detail:i});this.OuterWrapper.dispatchEvent(n)},_selectItemByValue:function(e,t){var i=new Promise(function(e){this._resolveFetchDataAndSelectPromise=e}.bind(this));if(null!=e){var n={key:e};this._fetchDataAndSelect(n,t)}else this._handleSelection(this._valueItemForPlaceholder);return i}}),p.setDefaultOptions({ojSelect2:{displayOptions:{converterHint:["none"]}}})});
//# sourceMappingURL=ojselectsingle.js.map