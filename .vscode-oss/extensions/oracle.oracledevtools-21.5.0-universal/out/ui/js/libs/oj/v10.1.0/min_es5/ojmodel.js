!function(){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}
/**
 * @license
 * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */define(["exports","ojs/ojcore-base","ojs/ojlogger","jquery","ojs/ojconfig"],function(e,r,n,o,i){"use strict";r=r&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r,o=o&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o;
/**
   * @license
   * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */
var s={on:function(t,e,r){return this.OnInternal(t,e,r,!1,!1)},off:function(t,e,r){return this._offInternal(t,e,r,!1)},trigger:function(t){var e=Array.prototype.slice.call(arguments);return e.unshift(!1),s.TriggerInternal.apply(this,e)},once:function(t,e,r){return this._onceInternal(t,e,r,!1,null)},listenTo:function(t,e,r){var n,o,i,a,l,u,c,h={};for(c in e.constructor===String?h[e]=r:h=e,h)if(h.hasOwnProperty(c))for(n=s._getEvents(c),o=0;o<n.length;o+=1)u={event:i=n[o].event,attribute:a=n[o].attribute,object:t,callback:h[c]},l=a?i+":"+a:i,void 0===this._listeningTo&&(this._listeningTo=[]),this._listeningTo.push(u),t.OnInternal(l,h[c],null,!0,!1);return this},listenToOnce:function(t,e,r){var n,o,i,a,l,u,c,h={};for(c in e.constructor===String?h[e]=r:h=e,h)if(h.hasOwnProperty(c))for(n=s._getEvents(c),o=0;o<n.length;o+=1)u={event:i=n[o].event,attribute:a=n[o].attribute,object:t,callback:h[c]},l=a?i+":"+a:i,void 0===this._listeningTo&&(this._listeningTo=[]),this._listeningTo.push(u),t._onceInternal(l,h[c],null,!0,this);return this},stopListening:function(t,e,r){var n,o,i,a,l,u,c,h,p,f,d,_,g,y={};if(null==arguments||arguments.length<=1){for(_=this._listeningTo?this._listeningTo.length:0,d=0;d<_;d++)u=this._listeningTo[d],(c=!t||t===u.object)&&u.object._offInternal.apply(u.object,[u.event,u.callback,u.context,!0]);return this._listeningTo=[],this}for(g in o=e,t&&t.constructor===String&&(o=t),o.constructor===String?y[o]=r:y=o,y)if(y.hasOwnProperty(g))for(n=s._getEvents(g),i=0;i<n.length;i+=1)for(a=n[i].event,l=n[i].attribute,d=(_=this._listeningTo?this._listeningTo.length:0)-1;d>=0;d-=1)u=this._listeningTo[d],c=!t||t===u.object,h=!a||a===u.event,p=!r||y[g]===u.callback,f=!l||l===u.attribute,c&&h&&p&&f&&(this._listeningTo[d].object._offInternal.apply(this._listeningTo[d].object,[this._listeningTo[d].event,this._listeningTo[d].callback,this._listeningTo[d].context,!0]),this._listeningTo.splice(d,1));return this},EventType:{ADD:"add",ALLADDED:"alladded",REMOVE:"remove",RESET:"reset",REFRESH:"refresh",SORT:"sort",CHANGE:"change",DESTROY:"destroy",ALLREMOVED:"allremoved",REQUEST:"request",SYNC:"sync",ERROR:"error",INVALID:"invalid",READY:"ready",ALL:"all"}};s.bind=s.on,s.unbind=s.off,s.Mixin=function(t,e){var r,n=e||this;for(r in n)"function"==typeof n[r]&&(t[r]=n[r]);t.eventHandlers={},t._listeningTo=[]},s._onceInternal=function(t,e,r,n,o){var i,s,a,l,u,c,h;c=this._getEventMap(t,e,r),u=c.map,h=c.context;var p=this;return Object.keys(u||{}).forEach(function(t){if(Object.prototype.hasOwnProperty.call(u,t))for(i=p._getEvents(t),s=0;s<i.length;s+=1)a=i[s].event,l=i[s].attribute,void 0===p.eventHandlers&&(p.eventHandlers=[]),void 0===p.eventHandlers[a]&&(p.eventHandlers[a]=[]),p.eventHandlers[a].push({callback:u[t],context:h,attribute:l,once:!0,fired:!1,listen:n,otherObj:o})}),this},s._shouldFire=function(t){return!t.once||!t.fired&&(t.fired=!0,!0)},s._getContext=function(t,e){return e.context||e.otherObj||t},s.TriggerInternal=function(t,e){var r,n,o,i,a,l,u,c,h,p=this._getEvents(e);for(i=[],r=0;r<p.length;r+=1)n=p[r].event,o=p[r].attribute,i.push({event:n,attribute:o});for(r=0;r<i.length;r+=1){for(c=this._getHandlers(this.eventHandlers,s.EventType.ALL),a=s._getHandlers(this.eventHandlers,i[r].event,!1),l=0;l<(a?a.length:0);l+=1)a[l].attribute===i[r].attribute&&a[l].callback&&(u=Array.prototype.slice.call(arguments),a&&a[l]&&a[l].once&&(this._removeHandler(s._getHandlers(this.eventHandlers,i[r].event,!0),a[l]),a[l].otherObj&&a[l].otherObj.stopListening(this,e,a[l].callback)),a&&a[l]&&this._shouldFire(a[l])&&(h=a[l].callback,t&&!a[l].ignoreSilent||h.apply(s._getContext(this,a[l]),u.slice(2))));for(l=0;l<(c?c.length:0);l+=1)(u=Array.prototype.slice.call(arguments)).length>0&&(i[r].attribute?u[1]=i[r].event+":"+i[r].attribute:u[1]=i[r].event),c&&c[l]&&c[l].callback&&this._shouldFire(c[l])&&(h=c[l].callback,t&&!c[l].ignoreSilent||h.apply(s._getContext(this,c[l]),u.slice(1))),c&&c[l]&&c[l].once&&(this._removeHandler(this._getHandlers(this.eventHandlers,s.EventType.ALL,!0),c[l]),c[l].otherObj&&c[l].otherObj.stopListening(this,s.EventType.ALL,c[l].callback))}return this},s.OnInternal=function(t,e,r,n,o){var i,a,l,u,c,h,p,f,d=this._getEventMap(t,e,r);for(f in i=d.map,p=d.context,i)if(i.hasOwnProperty(f))for(a=this._getEvents(f),l=0;l<a.length;l+=1)u=a[l].event,c=a[l].attribute,void 0===this.eventHandlers&&(this.eventHandlers=[]),void 0===this.eventHandlers[u]&&(this.eventHandlers[u]=[]),h={callback:i[f],context:p,attribute:c,listen:n,ignoreSilent:o},-1===this._checkForHandler(this.eventHandlers[u],h,s._handlersIdentical)&&this.eventHandlers[u].push(h);return this},s._offInternal=function(t,e,r,n){var o,i,s,a=r;if(null==arguments||0===arguments.length)return this.eventHandlers={},this;if(null==t)return this._removeEvent(t,e,r,n),this;for(s in o=(i=this._getEventMap(t,e,r)).map,a=i.context,o)o.hasOwnProperty(s)&&this._removeEvent(s,o[s],a,n);return this},s._getEventMap=function(t,e,r){var n={};return t.constructor!==String?{map:n=t,context:e}:(n[t]=e,{map:n,context:r})},s._removeEvent=function(t,e,r,n){var o,i,a,l,u,c,h,p,f,d=[];if(t)d=s._getEvents(t);else if(void 0!==this.eventHandlers){var _=this;Object.keys(this.eventHandlers||{}).forEach(function(t){Object.prototype.hasOwnProperty.call(_.eventHandlers,t)&&d.push({event:t})})}for(o=0;o<d.length;o+=1)if(i=d[o].event,l=d[o].attribute,void 0!==this.eventHandlers&&this.eventHandlers[i]instanceof Array){for(a=(u=this.eventHandlers[i]).length-1;a>=0;a-=1)c=null==e||u[a].callback===e,h=null==r||u[a].context===r,p=null==l||u[a].attribute===l,f=null==n||u[a].listen===n,c&&h&&p&&f&&u.splice(a,1);0===u.length&&delete this.eventHandlers[i]}},s._removeHandler=function(t,e){var r,n,o,i,s,a;if(t)for(r=t.length-1;r>=0;r-=1)n=void 0===e.callback||null===e.callback||t[r].callback===e.callback,o=void 0===e.context||null===e.context||t[r].context===e.context,i=void 0===e.attribute||null===e.attribute||t[r].attribute===e.attribute,s=void 0===e.listen||null===e.listen||t[r].listen===e.listen,a=void 0===e.once||null===e.once||t[r].once===e.once,n&&o&&i&&s&&a&&t.splice(r,1)},s._getEvents=function(t){var e,r,n,o,i=t?t.split(" "):[],s=[];for(e=0;e<i.length;e+=1)n=(r=i[e].split(":"))[0],o=r.length>1?r[1]:null,s.push({event:n,attribute:o});return s},s._handlersIdentical=function(t,e){return t.callback===e.callback&&t.attribute===e.attribute&&t.context===e.context&&t.listen===e.listen&&t.once===e.once},s._listenersIdentical=function(t,e){return t.event===e.event&&t.attribute===e.attribute&&t.context===e.context&&t.object===e.object},s._checkForHandler=function(t,e,r){var n;if(void 0===t)return-1;for(n=0;n<t.length;n+=1)if(r(t[n],e))return n;return-1},s._getHandlers=function(t,e,r){if(t&&t[e]instanceof Array){if(r)return t[e];var n,o=[];for(n=0;n<t[e].length;n++)o.push(t[e][n]);return o}return null},r._registerLegacyNamespaceProp("Events",s);
/**
   * @license
   * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */
var a=function(){this.name="URLError",this.message="No URL defined"};r._registerLegacyNamespaceProp("URLError",a),a.prototype=new Error,a.constructor=a;
/**
   * @license
   * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */
var l=function(t,e){this.rootURL=t,this.model=e,this.customURL=e.customURL,o.support.cors=!0};r._registerLegacyNamespaceProp("RestImpl",l),l._HEADER_PROP="headers",l.addOptions=function(t,e,r){var n=o.extend(!0,t,r);return e&&Object.keys(e||{}).forEach(function(t){Object.prototype.hasOwnProperty.call(e,t)&&"oauthHeader"!==t&&(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=e[t]),t===l._HEADER_PROP&&(n[t]=o.extend(!0,n[t],e[t])))}),e.oauthHeader&&(n[l._HEADER_PROP]||(n[l._HEADER_PROP]={}),Object.keys(e.oauthHeader||{}).forEach(function(t){Object.prototype.hasOwnProperty.call(e.oauthHeader,t)&&(Object.prototype.hasOwnProperty.call(n[l._HEADER_PROP],t)||(n[l._HEADER_PROP][t]=e.oauthHeader[t]))})),n},l.prototype.getRecords=function(t,e,r,n){var o=r||{},i="jsonp"===o.dataType,s=this._getURL("read",this.rootURL,this.customURL,null,n,o),a={crossDomain:o.crossDomain||!i,dataType:this._getDataType(o),jsonpCallback:o.jsonpCallback,context:null!==n?n:this,success:t,error:e};return a=this._addHeaderProp(a),a=l.addOptions(a,o,s),o.xhr=this.ajax(a,n),o.xhr},l.prototype._addHeaderProp=function(t){var e=t||{};return this.model&&this.model.omitLanguageHeader||(e[l._HEADER_PROP]={"Accept-Language":this.getLocale()}),e},l.prototype.getRecord=function(t,e,r,n,o){var i=n||{},s="jsonp"===i.dataType,a=this._getURL("read",this.rootURL,this.customURL,r,o,i),u={crossDomain:i.crossDomain||!s,dataType:this._getDataType(i),jsonpCallback:i.jsonpCallback,context:null!==o?o:this,success:t,error:e};return u=this._addHeaderProp(u),u=l.addOptions(u,i,a),i.xhr=this.ajax(u,o),i.xhr},l.prototype.updateRecord=function(t,e,r,n,o,i,s){var a=o||{},u="jsonp"===a.dataType,c=this._getURL(s?"patch":"update",this.rootURL,this.customURL,e,i,a),h=l._emulateHTTP(a),p={crossDomain:a.crossDomain||!u,contentType:this._getContentType(a),dataType:this._getDataType(a),jsonpCallback:a.jsonpCallback,data:this._getData(JSON.stringify(r),a,c),emulateHTTP:h,emulateJSON:l._emulateJSON(a),success:t,error:n,context:null!==i?i:this};return p=this._addHeaderProp(p),p=l.addOptions(p,a,c),p=l._beforeSendMod(h,p),a.xhr=this.ajax(p,i),a.xhr},l._beforeSendMod=function(t,e){var r=e||{};if(t){var n=r.beforeSend;r.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",r._method),n?n.apply(this,arguments):null}}return r},l.prototype._getData=function(t,e,r){if(l._emulateJSON(e)){var n={_method:r._method?r._method:r.type};return t&&(n.model=t),n}return t},l.prototype._getHTTPMethod=function(t,e){if(e.type)return{method:e.type};var r=null;if("create"===t&&(r="POST"),"delete"===t&&(r="DELETE"),"patch"===t&&(r="PATCH"),"update"===t&&(r="PUT"),l._emulateHTTP(e)){var n={method:"POST"};return n._method=r,n}return null===r&&(r="GET"),{method:r}},l._emulateHTTP=function(t){return t.emulateHTTP||r.emulateHTTP},l._emulateJSON=function(t){return t.emulateJSON||r.emulateJSON},l.prototype._getURL=function(t,e,n,i,s,a){var u=this._getHTTPMethod(t,a);if(o.isFunction(n)){var c=n.call(this,t,s,l.SetCustomURLOptions(i,s,a));if(r.StringUtils.isString(c)){var h={url:c,type:u.method};return u._method&&(h._method=u._method),h}if(c)return c.url=Object.prototype.hasOwnProperty.call(c,"url")?c.url:e,Object.prototype.hasOwnProperty.call(c,"type")||(c.type=u.method),Object.prototype.hasOwnProperty.call(c,"data")||u._method&&(c._method=u._method),c}var p={url:l.GetPropValue(null,e),type:u.method};return u._method&&(p._method=u._method),p},l.prototype.deleteRecord=function(t,e,r,n){var o=r||{},i="jsonp"===o.dataType,s=this._getURL("delete",this.rootURL,this.customURL,t,n,o),a=l._emulateHTTP(o),u=l._emulateJSON(o),c={crossDomain:o.crossDomain||!i,success:o.success,error:e,context:null!==n?n:this,emulateHTTP:a,emulateJSON:u},h=this._getData(null,o,s);return h&&(c.data=h),c=l.addOptions(c,o,s),c=l._beforeSendMod(a,c),o.xhr=this.ajax(c,n),o.xhr},l.prototype.addRecord=function(t,e,r,n){var o=r||{},i=JSON.stringify(t),s="jsonp"===o.dataType,a=this._getURL("create",this.rootURL,this.customURL,null,n,o),u=l._emulateHTTP(o),c={crossDomain:o.crossDomain||!s,contentType:o.contentType||"application/json",dataType:this._getDataType(o),jsonpCallback:o.jsonpCallback,data:this._getData(i,o,a),success:o.success,error:e,emulateHTTP:u,emulateJSON:l._emulateJSON(o),context:null!==n?n:this};return c=this._addHeaderProp(c),c=l.addOptions(c,o,a),o.xhr=this.ajax(c,n),o.xhr},l.prototype._getDataType=function(t){return l._emulateJSON(t)&&!l._emulateHTTP(t)?"application/x-www-form-urlencoded":t.dataType||"json"},l.prototype._getContentType=function(t){return l._emulateJSON(t)&&!l._emulateHTTP(t)?"application/x-www-form-urlencoded":t.contentType||"application/json"},l.prototype.getLocale=function(){return i.getLocale()},l.prototype.ajax=function(t,e){if(null===t.url||void 0===t.url)throw new a;var n=r.ajax(t);return e._addxhr&&e._addxhr(n),n},l.SetCustomURLOptions=function(t,e,n){var o=e instanceof r.Collection?e.ModifyOptionsForCustomURL(n):{};return t&&(o.recordID=t),o},l.GetPropValue=function(t,e){return t?o.isFunction(t[e])?t[e]():t[e]:o.isFunction(e)?e():e};
/**
   * @license
   * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */
var u=function t(e,r){t._init(this,e,r,null)};r._registerLegacyNamespaceProp("Model",u),r.Object.createSubclass(u,r.Object,"oj.Model"),u.prototype.Init=function(){u.superclass.Init.call(this)},u.prototype.attributes={},u.prototype.defaults={},u.prototype.id=null,u.prototype.idAttribute="id",u.prototype.urlRoot=null,u.prototype.customURL=null,u.prototype.validate=null,u.prototype.validationError=null,u.prototype.omitLanguageHeader=!1,u._idCount=0,u._init=function(t,e,r,n){var i,a,l;if(!u._justExtending){t.Init(),s.Mixin(t),t._clearChanged(),t.previousAttrs={},t.nestedSet=!1,t.index=-1;var c=r||{};for(l in t.attributes={},t.defaults&&!c.ignoreDefaults&&(t.attributes=u._cloneAttributes(o.isFunction(t.defaults)?t.defaults():t.defaults,null)),n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l]);if(e)if(i=c.parse,o.isFunction(i)&&(t.parse=i),a=u._cloneAttributes(e,t.attributes),t.attributes=a,null==(a=i?t.parse(a):a)||void 0===a)t.attributes={};else for(l in a)Object.prototype.hasOwnProperty.call(a,l)&&t._setProp(l,a[l],!1,!1,c,!0);t.SetCid(),t.SetCollection(c.collection),c.customURL&&(t.customURL=c.customURL),c.url&&(t.url=c.url),c.urlRoot&&(t.urlRoot=c.urlRoot),t.initialize&&t.initialize(e,c),t.SetupId()}},u.extend=function(t,e){var r;u._justExtending=!0,r=new u,u._justExtending=!1,o.extend(r,this.prototype);var n,i=t||{};return Object.keys(i).forEach(function(t){Object.prototype.hasOwnProperty.call(i,t)&&(r[t]=i[t])}),n=i&&i.constructor&&Object.prototype.hasOwnProperty.call(i,"constructor")?i.constructor:function(t,e){u._init(this,t,e,i)},o.extend(n,this),n.prototype=r,n.extend=u.extend,n.prototype.constructor=n,s.Mixin(n,this),e&&Object.keys(e).forEach(function(t){Object.prototype.hasOwnProperty.call(e,t)&&(n[t]=e[t])}),n},u.prototype.TriggerInternal=function(t,e,r,n,o){},u.prototype.SetCid=function(){this.GetCid()||(this.cid="id"+u._idCount,u._idCount+=1)},u.prototype.GetCid=function(){return this.cid},u.prototype.SetIndex=function(t){this.index=t},u.prototype.GetIndex=function(){return this.index},u.prototype.SetNext=function(t){var e=this.nextModel;return this.nextModel=t,e},u.prototype.GetNext=function(){return this.nextModel},u.prototype.SetPrevious=function(t){var e=this.previousModel;return this.previousModel=t,e},u.prototype.GetPrevious=function(){return this.previousModel},u.prototype.Merge=function(t,e,n){var o,i=!1,s=r.StringUtils.isString(e),a=!1,l=this;return Object.keys(t.attributes||{}).forEach(function(r){Object.prototype.hasOwnProperty.call(t.attributes,r)&&(o=l.attributes[r]!==t.attributes[r],s?r===e&&o&&(i=!0):o&&(i=!0),o&&(a=!0,l.attributes[r]=t.attributes[r],l._addChange(r,t.attributes[r]),l._fireAttrChange(r,l.attributes[r],null,n)))}),this.SetupId(),a&&this._fireChange(null,n),i},u._hasProperties=function(t){var e;if(t&&t instanceof Object)for(e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!0;return!1},u.prototype.SetCollection=function(t){null!=t?(this.collection=t,this.SetupId()):delete this.collection},u.prototype.GetCollection=function(){return this.collection},u.prototype._fireAttrChange=function(t,e,r,n){null!=t&&this.TriggerInternal(n,s.EventType.CHANGE+":"+t,this,e,r)},u.prototype._fireChange=function(t,e){this.TriggerInternal(e,s.EventType.CHANGE,this,t,null)},u.prototype.SetupId=function(){var t=null;if(this.collection&&this.collection.modelId){var e=this.collection.modelId;t=o.isFunction(e)?e.call(this.collection,this.attributes):e}if(!t){var r=this._getIdAttr();t=null!=this.attributes?this.attributes[r]:null}this.id=t},u.prototype._setPropInternal=function(t,e,n){var o=r.Object.__innerEquals(this.attributes[t],e);return!(!n&&o)&&(this.attributes[t]=e,this.SetupId(),!o)},u.prototype._clearChanged=function(){this.changed={}},u.prototype._addChange=function(t,e){this.changed[t]=e},u.prototype._setProp=function(t,e,r,n,o,i){if(null==t)return!0;var s,a={},l=this.nestedSet;if(n?Object.keys(t).forEach(function(e){Object.prototype.hasOwnProperty.call(t,e)&&(a[e]=t[e])}):a[t]=e,s=o||{},!this._checkValid(a,{validate:s.validate},!1))return!1;l||(this._clearChanged(),this.changes=[]),this.nestedSet||i||(this.previousAttrs=u._cloneAttributes(this.attributes,null)),this.nestedSet=!0;var c=this;Object.keys(a).forEach(function(t){Object.prototype.hasOwnProperty.call(a,t)&&(c._setPropInternal(t,a[t],r)?(c._addChange(t,a[t]),c.changes.push(t)):delete a[t])});var h=s.silent;if(Object.keys(a).forEach(function(t){Object.prototype.hasOwnProperty.call(a,t)&&(!h&&(c.changes.length>0||l&&-1===c.changes.indexOf(t))&&(c.pendingChanges=!0,c.pendingOpts=s),c._fireAttrChange(t,a[t],s,h))}),l)return!0;if(!h&&!l)for(;this.pendingChanges;)this.pendingChanges=!1,this._fireChange(this.pendingOpts,h);return this.nestedSet=!1,!0},u.prototype.clear=function(t){var e,r,n={silent:!0},o=t||{};e=o.silent,n.validate=o.validate,this._clearChanged();for(r in this.attributes)if(Object.prototype.hasOwnProperty.call(this.attributes,r)){if(!this._unsetInternal(r,n,!0))return!1;this.TriggerInternal(e,s.EventType.CHANGE+":"+r,this,void 0,null)}return this.attributes={},this.SetupId(),this._fireAttrChange(null,null,null,e),this._fireChange(null,e),this},u._cloneAttributes=function(e,n){var i,s,a=n||{},l=!0;if(("object"===t(a)?Object.keys(a):[]).length>0){for(i in a)Object.prototype.hasOwnProperty.call(a,i)&&Object.prototype.hasOwnProperty.call(e,i)&&void 0===e[i]&&delete e[i];return r.CollectionUtils.copyInto(a,e,void 0,!0,1e4),a}for(i in e)if("function"===(s=o.type(e[i]))||"undefined"===s||"date"===s||"array"===s||"object"===s){l=!1;break}return l?a=JSON.parse(JSON.stringify(e)):"object"===t(e)&&r.CollectionUtils.copyInto(a,e,void 0,!0,1e4),a},u.prototype.clone=function(){var t,e=new this.constructor;for(t in this)Object.prototype.hasOwnProperty.call(this,t)&&this[t]!==this.attributes&&(e[t]=this[t]);return e.attributes=u._cloneAttributes(this.attributes,null),delete e.cid,e.SetCid(),e.SetupId(),e},u.prototype.Match=function(t,e){var r,n=this.GetId();return void 0!==n&&n==t||void 0!==(r=this.cid)&&r==e},u.prototype.set=function(t,e,n){var o,i=n||{},s=!0;if(arguments&&arguments.length>0)if(r.StringUtils.isString(t))i.unset?this._unsetInternal(t,null,!1):this._setProp(t,e,!1,!1,i,!1)||(s=!1);else if((i=e||{}).unset)for(o in t)Object.prototype.hasOwnProperty.call(t,o)&&this._unsetInternal(o,null,!1);else this._setProp(t,null,!0,!0,i,!1)||(s=!1);return!!s&&this},u.prototype.unset=function(t,e){return this._unsetInternal(t,e,!1)},u.prototype._unsetInternal=function(t,e,r){var n=e||{},o=n.silent;if(this.has(t)){if(!this._checkValid({},n,!1))return!1;r||this._clearChanged(),delete this.attributes[t],this._addChange(t,void 0),this._fireAttrChange(t,null,null,o),this._fireChange(null,o)}return this.SetupId(),!0},u.prototype.get=function(t){return this.attributes[t]},u.prototype.has=function(t){return r.Collection._defined(this.attributes[t])},u.prototype.fetch=function(t){var e,r=t||{},n=r.success,i=r.error,s=this;return(e=u._copyOptions(r)).error=function(e,n,o){u._triggerError(s,!1,r,n,o,e),i&&i.apply(s,[s,o,t,e,n])},e.success=function(t){e.xhr&&(r.xhr=e.xhr),u._fireSyncEvent(s,t,e,!1),o.isFunction(s.parse)&&s.set(s.parse(t),e),n&&n.call(u.GetContext(e,s),s,t,r)},u._internalSync("read",this,e)},u.prototype._parseImpl=function(t){return t},u.prototype.parse=u.prototype._parseImpl,u.prototype.url=function(){var t,e,r=this._getUrlRoot(),n=this.GetId();if(r)return n?r+"/"+encodeURIComponent(n):r;if(t=this.collection)return e=l.GetPropValue(t,"url"),n&&e?e+("/"===u._getLastChar(e)?"":"/")+encodeURIComponent(this.GetId()):e;throw new a},u.prototype.keys=function(){var t=[],e=this;return Object.keys(e.attributes||{}).forEach(function(r){Object.prototype.hasOwnProperty.call(e.attributes,r)&&t.push(r)}),t},u.prototype.values=function(){var t=[],e=this;return Object.keys(e.attributes||{}).forEach(function(r){Object.prototype.hasOwnProperty.call(e.attributes,r)&&t.push(e.get(r))}),t},u.prototype.pairs=function(){var t,e=[],r=this;return Object.keys(r.attributes||{}).forEach(function(n){Object.prototype.hasOwnProperty.call(r.attributes,n)&&((t=[]).push(n),t.push(r.get(n)),e.push(t))}),e},u.prototype.omit=function(t){var e,r=[],n={};if(t instanceof Array)r=t;else for(e=0;e<arguments.length;e++)r.push(arguments[e]);var o=this;return Object.keys(o.attributes||{}).forEach(function(t){Object.prototype.hasOwnProperty.call(o.attributes,t)&&-1===r.indexOf(t)&&(n[t]=o.get(t))}),n},u.prototype.pick=function(t){var e,r=[],n={};if(t instanceof Array)r=t;else for(e=0;e<arguments.length;e++)r.push(arguments[e]);for(e=0;e<r.length;e++)Object.prototype.hasOwnProperty.call(this.attributes,r[e])&&(n[r[e]]=this.get(r[e]));return n},u.prototype.invert=function(){var t,e={},r=this;return Object.keys(r.attributes||{}).forEach(function(n){Object.prototype.hasOwnProperty.call(r.attributes,n)&&(t=r.get(n),e[t]=n)}),e},u._getLastChar=function(t){return t.charAt(t.length-1)},u.prototype._saveUrl=function(){var t=this._getUrlRoot();return t||(this.GetCollection()?this.GetCollection().url:null)},u.prototype._getUrlRoot=function(){return l.GetPropValue(this,"urlRoot")},u.prototype._parseSaveImpl=function(t){return t},u.prototype.parseSave=u.prototype._parseSaveImpl,u.prototype.isValid=function(){var t={};return t.validate=this.validate,this._checkValid(this.attributes,t,!1)},u._isValidateSet=function(t,e){var r=t||{};return void 0!==r.validate&&null!==r.validate?r.validate:e},u.prototype._checkValid=function(t,e,r){var n=e||{},o=this.validate;return!(o&&u._isValidateSet(n,r)&&(this.validationError=o.call(this,t,n),this.validationError))||(this.TriggerInternal(!1,s.EventType.INVALID,this,this.validationError,n),!1)},u._processArgs=function(t){var e,n=!1,o={},i={};if(t&&t.length>0){if(t.length>1&&t[t.length-1]&&u._hasProperties(t[t.length-1])&&(n=!0,o=t[t.length-1]||{}),null==t[0])return{attributes:null,options:o};if(u._hasProperties(t[0])||r.Object.isEmpty(t[0]))Object.keys(t[0]).forEach(function(e){Object.prototype.hasOwnProperty.call(t[0],e)&&(i[e]=t[0][e])});else for(e=0;e<t.length;e+=2)(void 0!==t[e]||e<t.length-1||!n&&e===t.length-1)&&(i[t[e]]=t[e+1])}return{attributes:i,options:o}},u._copyOptions=function(t){var e={},r=t||{};return Object.keys(r).forEach(function(t){Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])}),e},u._triggerError=function(t,e,r,n,o,i){var a=r||{};a.textStatus=n,a.errorThrown=o,t.TriggerInternal(e,s.EventType.ERROR,t,i,a)},u.prototype.save=function(t,e){var n,i,s,a,l,c,h,p,f,d=u._processArgs(arguments);f=void 0===t?void 0:d.attributes;var _=e||{};h=u._copyOptions(d.options);var g=o.extend(!0,{},this.attributes,f);return!!this._checkValid(g,h,!0)&&(h.wait||this.set(f),n=void 0!==h.forceNew&&h.forceNew,a=this,l=h.error,c=h.patch,h.error=function(t,r,n){u._triggerError(a,!1,_,r,n,t),l&&l.apply(a,[a,n,e,t,r])},h.saveAttrs=h.wait?this._attrUnion(f):this.attributes,p=this.attributes,this.attributes=h.saveAttrs,h.saveAttrs=this.toJSON(),this.attributes=p,n||this.isNew()?(s=u._getSuccess(h),h.success=function(t){var e;if(h.xhr&&(_.xhr=h.xhr),t&&!r.Object.isEmpty(t)){if(e=o.isFunction(a.parse)?a.parse(t):t,!a._checkValid(e,h,!0))return;a.attributes=o.extend(!0,a.attributes,e),h.wait&&Object.keys(f||{}).forEach(function(t){Object.prototype.hasOwnProperty.call(e,t)&&(f[t]=e[t])}),a.SetupId()}u._fireSyncEvent(a,t,h,!1),h.wait&&a.set(f),s&&s.call(u.GetContext(h,a),a,t,_),a._clearChanged()},h.attrs||(h.attrs=h.saveAttrs),h.parse=!0,c&&(h.saveAttrs=h.attrs),u._internalSync("create",this,h)):(i=h.success,h.success=function(t){var e;h.xhr&&(_.xhr=h.xhr),t&&!r.Object.isEmpty(t)&&(e=o.isFunction(a.parse)?a.parse(t):t,a.attributes=o.extend(!0,a.attributes,e),h.wait&&Object.keys(f||{}).forEach(function(t){Object.prototype.hasOwnProperty.call(e,t)&&(f[t]=e[t])}),a.SetupId()),u._fireSyncEvent(a,t,h,!1),h.wait&&a.set(f),i&&i.call(u.GetContext(h,a),a,t,_),a._clearChanged()},h.attrs||(h.attrs=void 0===f?void 0:c?f:h.saveAttrs),u._internalSync(c?"patch":"update",this,h)))},u.prototype._attrUnion=function(t){var e={},r=this;return Object.keys(r.attributes||{}).forEach(function(t){Object.prototype.hasOwnProperty.call(r.attributes,t)&&(e[t]=r.attributes[t])}),Object.keys(t||{}).forEach(function(r){Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}),e},u.IsComplexValue=function(t){return t&&Object.prototype.hasOwnProperty.call(t,"value")&&Object.prototype.hasOwnProperty.call(t,"comparator")},u.prototype._hasAttrs=function(t){var e;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e)){if(!Object.prototype.hasOwnProperty.call(this.attributes,e))return!1;for(var n=Array.isArray(t[e])?t[e]:[t[e]],o=0;o<n.length;o++)if(u.IsComplexValue(n[o])){var i=n[o].comparator,s=n[o].value;if(r.StringUtils.isString(i))throw new Error("String comparator invalid for local where/findWhere");if(!i(this,e,s))return!1}else if(t[e]!==this.attributes[e])return!1}return!0},u.prototype.matches=function(t){return function(e){for(var r in t)if(e.get(r)!==t[r])return!1;return!0}(this)},u.prototype.Contains=function(t){var e,r=t.constructor===Array?t:[t];for(e=0;e<r.length;e++)if(this._hasAttrs(r[e]))return!0;return!1},u._getSuccess=function(t){return null!=t&&t.success?t.success:null},u.GetContext=function(t,e){return void 0!==t&&void 0!==t.context?t.context:e},u.prototype.isNew=function(){return void 0===this.GetId()},u.prototype._getIdAttr=function(){return this.idAttribute||"id"},u.prototype.GetId=function(){return this.id},u.prototype.changedAttributes=function(t){if(t){var e={},n=this;return Object.keys(t).forEach(function(o){Object.prototype.hasOwnProperty.call(t,o)&&(r.Object.__innerEquals(t[o],n.attributes[o])||(e[o]=t[o]))}),!r.Object.isEmpty(e)&&e}return!r.Object.isEmpty(this.changed)&&this.changed},u.prototype.hasChanged=function(t){return void 0!==t?u._hasProperties(this.changed)&&Object.prototype.hasOwnProperty.call(this.changed,t):u._hasProperties(this.changed)},u.prototype.destroy=function(t){var e,n,o,i=t||{},a=i.wait,l=i.error,c=this;o=u._copyOptions(i),e=u._getSuccess(o);var h=this.GetCollection();return o.success=function(t){if(o.xhr&&(i.xhr=o.xhr),h){var n=r.StringUtils.isString(t)&&!r.StringUtils.isEmpty(t)?JSON.parse(t):t;h._setPagingReturnValues(n,null,t,!0)}a&&c._fireDestroy(!1),u._fireSyncEvent(c,t,o,!1),e&&e.call(u.GetContext(o,c),c,t,i)},o.error=function(e,r,n){c.TriggerInternal(!1,s.EventType.ERROR,c,e,i),l&&l.apply(c,[c,n,t,e,r])},this.isNew()?(a||this._fireDestroy(!1),e&&e.call(u.GetContext(o,c),c,null,i),!1):(n=u._internalSync("delete",this,o),a||this._fireDestroy(!1),n)},u.prototype._fireRequest=function(t,e,r,n){this.TriggerInternal(n,s.EventType.REQUEST,t,e,r)},u.prototype._fireDestroy=function(t){this.TriggerInternal(t,s.EventType.DESTROY,this,this.collection,null)},u._fireSyncEvent=function(t,e,r,n){t.TriggerInternal(n,s.EventType.SYNC,t,e,r)},u.prototype.toJSON=function(){var t={},e=this;return Object.keys(e.attributes||{}).forEach(function(r){Object.prototype.hasOwnProperty.call(e.attributes,r)&&(Array.isArray(e.attributes[r])?t[r]=e.attributes[r].slice(0):t[r]=e.attributes[r])}),t},u.prototype.previous=function(t){return this.previousAttrs[t]},u.prototype.previousAttributes=function(){return this.previousAttrs},u.prototype.sync=function(t,e,n){return r.sync(t,e,n)},u._internalSync=function(t,e,r){var n=r||{};e.oauth&&(n.oauthHeader=e.oauth.getHeader()),!n.dataType&&e.dataType&&(n.dataType=e.dataType),!n.jsonpCallback&&e.jsonpCallback&&(n.jsonpCallback=e.jsonpCallback),"create"!==t&&"patch"!==t&&"update"!==t||(n.parsedData=e.parseSave.call(e,"patch"===t?n.attrs:n.saveAttrs));var o=null;e instanceof u&&(o=e.GetId());var i={};Object.keys(n||{}).forEach(function(t){i[t]=n[t]});var s=l.SetCustomURLOptions(o,e,n);return Object.keys(s||{}).forEach(function(t){i[t]=s[t]}),n.xhr=e.sync(t,e,i),i.xhr&&(n.xhr=i.xhr),n.xhr};var c=function(t,e,r){var n,o=r||{};function i(t){return e._fireRequest(e,t,o,o.silent),t}var s,a=o.success,c=o.error;if("create"===t.valueOf())return s=(s=e._saveUrl())||l.GetPropValue(e,"url"),i((n=new l(s,e)).addRecord(o.parsedData,c,o,e));if("read"===t.valueOf())return e instanceof u?(s=o.url?o.url:l.GetPropValue(e,"url"),i((n=new l(s,e)).getRecord(a,c,e.GetId(),o,u.GetContext(o,e)))):(s=e.GetCollectionFetchUrl(o),i((n=new l(s,e)).getRecords(a,c,o,e)));n=new l(l.GetPropValue(e,"url"),e);var h=null;return e instanceof u&&(h=e.GetId()),"update"===t.valueOf()?i(n.updateRecord(a,h,o.parsedData,c,o,e,!1)):"patch"===t.valueOf()?i(n.updateRecord(a,h,o.parsedData,c,o,e,!0)):"delete"===t.valueOf()?i(n.deleteRecord(h,c,o,e)):null};r._registerLegacyNamespaceProp("sync",c),u._urlError=function(t){if(!t.url)throw new Error("The url property or function must be specified")};var h=function(t){return arguments&&arguments.length>0&&u._urlError(arguments[0]),o.ajax.apply(r,arguments)};r._registerLegacyNamespaceProp("ajax",h);
/**
   * @license
   * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */
var p=function t(e,r){t._justExtending||t._init(this,e,r,null)};r._registerLegacyNamespaceProp("Collection",p),r.Object.createSubclass(p,r.Object,"oj.Collection"),p.prototype.model=null,p.prototype.modelId=function(t){var e=this.model;return e&&t?t[e.idAttribute||e.prototype.idAttribute||"id"]:null},p.prototype.length=void 0,p.prototype.models=void 0,p.prototype._modelIndices=[],p.prototype.url=null,p.prototype.changes=[],p.prototype.customURL=null,p.prototype.customPagingOptions=null,p.prototype.lastFetchSize=void 0,p.prototype.hasMore=!1,p.prototype.totalResults=void 0,p.prototype.lastFetchCount=void 0,p.prototype.modelLimit=-1,p.prototype.offset=void 0,p.prototype.fetchSize=-1,p.prototype.sortDirection=1,p.prototype.comparator=null,p.prototype.omitLanguageHeader=!1,p.prototype.Init=function(){p.superclass.Init.call(this)},p.extend=function(t,e){var r,n=null;return p._justExtending=!0,n=new p,p._justExtending=!1,o.extend(n,this.prototype),r=t&&t.constructor&&Object.prototype.hasOwnProperty.call(t,"constructor")?t.constructor:function(e,r){p._init(this,e,r,t)},e&&Object.keys(e).forEach(function(t){Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t])}),t&&Object.keys(t).forEach(function(e){Object.prototype.hasOwnProperty.call(t,e)&&(n[e]=t[e])}),o.extend(r,this),r.prototype=n,r.extend=p.extend,r.prototype.constructor=r,r},p._init=function(t,e,r,n){var o,i,a,l;if(t.Init(),s.Mixin(t),n)for(l in n)Object.prototype.hasOwnProperty.call(n,l)&&(t[l]=n[l]);var u=r||{};for(i=["comparator","customPagingOptions","customURL",p._FETCH_SIZE_PROP,"model","modelLimit","sortDirection","url"],o=0;o<i.length;o++)Object.prototype.hasOwnProperty.call(u,i[o])&&void 0!==u[i[o]]&&(t[i[o]]=u[i[o]]);void 0===t._getFetchSize(null)&&t.setFetchSize(-1),void 0===t.modelLimit&&t.setModelLimit(-1),t.hasMore=!1,t.lruCount=0,t._setModels([],!0);var c=e;u.parse&&(c=t.parse(e)),null!=c&&(u.noparse=!0,a=c instanceof Array?c:[c],t._addInternal(a,u,!0,!1)),t._setLength(),c||(t.totalResults=void 0),n&&n.initialize&&n.initialize.call(t,c,u)},p.prototype.on=function(t,e){},p.prototype.OnInternal=function(t,e,r,n,o){},p.prototype.TriggerInternal=function(t,e,r,n,o){},p.prototype._fireRequest=function(t,e,r,n){this.TriggerInternal(n,s.EventType.REQUEST,t,e,r)},p.prototype._resetChanges=function(){this.changes=[]},p.prototype._setChangeAt=function(t,e){for(var r=t;r<t+e;r++)-1===this.changes.indexOf(r)&&this.changes.push(r)},p.prototype._setModels=function(t,e){if(this.models=t,e)this._modelIndices=[],this._resetChanges();else for(var r=0;r<t.length;r++)t[r]&&this._modelIndices.push(r)},p.prototype._getModels=function(){return this.models},p.prototype._getModelsLength=function(){return this._getModels().length},p.prototype._overUpperLimit=function(t){return!(t<this._getModelsLength())&&!(this.IsVirtual()&&(!this._hasTotalResults()||0===this._getModelsLength()))},p.prototype._hasTotalResults=function(){return p._defined(this.totalResults)},p._defined=function(t){return null!=t},p.prototype._pushModel=function(t){this._getModels().push(t),this._modelIndices.push(this._getModelsLength()-1),this._setChangeAt(this._getModelsLength()-1,1)},p.prototype._pushModels=function(t){this._makeModelHead(t),this._pushModel(t),this.lruCount+=1,t.SetIndex(this._getModelsLength()-1)},p.prototype._reduceLRU=function(t){if(t)for(var e=0;e<t.length;e++)t[e]&&(this.lruCount-=1)},p.prototype._spliceModels=function(t,e,r){for(var n=t;n<t+e;n++)this._removePrevNext(this._getModel(n));void 0===r?(this._reduceLRU(this._getModels().splice(t,e)),this._spliceModelIndices(t,t+e-1)):(this._reduceLRU(this._getModels().splice(t,e,r)),this._spliceModelIndices(t,t+e-1),this._insertModelIndex(t),this._makeModelHead(r)),this._setChangeAt(t,e),this.lruCount<0&&(this.lruCount=0),this._realignModelIndices(t)},p.prototype._getModel=function(t){return this._getModels()[t]},p.prototype._realignModelIndices=function(t){for(var e,r=0;r<this._modelIndices.length;r++)(e=this._modelIndices[r])>=t&&this._getModel(e)&&this._getModel(e).SetIndex(e)},p.prototype._removePrevNext=function(t){if(t){var e=t.GetPrevious(),r=t.GetNext();e?e.SetNext(r):this.head=r,r?r.SetPrevious(e):this.tail=e}},p.prototype._makeModelHead=function(t){t.SetNext(this.head),this.head?this.head.SetPrevious(t):this.tail=t,t.SetPrevious(null),this.head=t},p.prototype._setModelIndex=function(t){-1===this._modelIndices.indexOf(t)&&this._modelIndices.push(t)},p.prototype._insertModelIndex=function(t){for(var e=0;e<this._modelIndices.length;e++)this._modelIndices[e]>=t&&(this._modelIndices[e]+=1);this._modelIndices.push(t)},p.prototype._spliceModelIndices=function(t,e){var r=void 0===e?t:e;this._clearModelIndices(t,r);for(var n=r-t+1,o=0;o<this._modelIndices.length;o++)this._modelIndices[o]>r&&(this._modelIndices[o]-=n)},p.prototype._clearModelIndices=function(t,e){for(var r=void 0===e?t:e,n=t;n<=r;n++){var o=this._modelIndices.indexOf(t);o>-1&&this._modelIndices.splice(o,1)}},p.prototype._setModel=function(t,e){var r=this._getModel(t);this._removePrevNext(r),r||(this.lruCount+=1),this._setChangeAt(t,1),this._getModels()[t]=e,e&&(this._setModelIndex(t),e.SetIndex(t),this._makeModelHead(e))},p.prototype._clearOutModels=function(t){var e,r,n=this.tail,o=0;for(this.tail=null;n&&o<t;)e=n.GetIndex(),(r=this._getModel(e))&&r.hasChanged()?(this.tail||(this.tail=n),n=n.GetPrevious()):(this.lruCount-=1,e>-1&&(this._setModel(e,void 0),this._clearModelIndices(e,e)),n.SetNext(null),n=n.SetPrevious(null),o+=1);this.tail||(this.tail=n),this.lruCount<0&&(this.lruCount=0),0===this.lruCount&&(this.head=null,this.tail=null)},p.prototype._resetLRU=function(){this.lruCount=0,this.head=null,this.tail=null},p.prototype._manageLRU=function(t){if(this.IsVirtual()){var e=this._getModelLimit();e>-1&&this.lruCount+t>e&&this._clearOutModels(this.lruCount+t-e)}},p.prototype.clone=function(){return this._cloneInternal(!0)},p.prototype._cloneInternal=function(t){var e,r,n=new this.constructor;if(this.IsVirtual()&&(n=this._copyFetchProperties(n))._resetModelsToFullLength(this.totalResults),n=this._copyProperties(n),t){var o,i=[];for(e=0;e<this._modelIndices.length;e++)i.push(this._modelIndices[e]);for(i.sort(function(t,e){return t-e}),e=0;e<i.length;e++)o=i[e],(r=this._atInternal(o,null,!0,!1))&&n._addInternal(r.clone(),{at:o},!0,!1)}return n},p.prototype._copyProperties=function(t){var e,r,n=["comparator","model","modelId"];for(r=0;r<n.length;r++)t[e=n[r]]=this[e];return t},p.prototype._copyFetchProperties=function(t){var e,r,n=["totalResults","hasMore",p._FETCH_SIZE_PROP];for(r=0;r<n.length;r++)t[e=n[r]]=this[e];return t},p.prototype._getLength=function(){return this.length},p.prototype._setLength=function(){var t=this._getModelsLength();this.length=t,this.IsVirtual()||(this.totalResults=t)},p._createModel=function(t,e,r){return t.model?o.isFunction(t.model)?new t.model(e,r):new t.model.constructor(e,r):null},p.prototype._newModel=function(t,e,r,n){var o,i=null,a=r||{};return a.ignoreDefaults=n,t instanceof u?i=t:this.model?i=p._createModel(this,t,a):(a.collection=this,i=new u(t,a)),a.validate&&i.validate&&(o=i.validate(i.attributes))?(a.validationError=o,this.TriggerInternal(!1,s.EventType.INVALID,i,o,a),null):i},p.prototype.add=function(t,e){this._manageLRU(1);var r=e||{};return this._handlePromise(this._addInternal(t,e,!1,r.deferred))},p.prototype._addInternal=function(t,e,o,i){var a,l,c,h=e||{},f=[],d=h.at,_=h.silent,g=h.force,y=h.merge||!1,v=h.sort,m=!0,I=!1,O=[],b=[];function E(t,e,i,a,u){var p,f=null;return!g&&y&&i?(m=i.Merge(e,t.comparator,_),f=i):(g||(p=o&&a.isNew()?void 0:t._getLocal(a))&&o&&d!==p.index&&n.warn("Duplicate ID fetched or added without merging, the id = "+p.GetId()),void 0===p?(!function(t,e){void 0===d?(t._pushModels(e),l=t._getModelsLength()-1,t._getModel(l).SetCid()):(l=d,t.IsVirtual()&&o?t._setModel(l,e):t._spliceModels(l,0,e),t._getModel(l).SetCid(),d+=1),void 0===e.GetCollection()&&e.SetCollection(t),t._setLength(),t._listenToModel(e),I=!0}(t,a),f=a):f=p),function(t,e,n,i,a){var u=h||{};o&&(u.fillIn=!0);var p=u.comparator||t._hasComparator();if((!o||o&&p)&&m&&void 0===e&&!v&&void 0===d&&t._getLength()>1){l>-1&&(c=t._getModel(l).cid);var f={};r.CollectionUtils.copyInto(f,u),f.add=!0,t.sort(f),l>-1&&(l=t.IsVirtual()?-1:t.indexOf(t.getByCid(c),a))}I&&(u.at&&(u.index=l),i?(i.TriggerInternal(_,s.EventType.ADD,i,t,u),O.push(i)):(n.TriggerInternal(_,s.EventType.ADD,n,t,u),O.push(n)))}(t,p,i,a,u),f}function P(t,e,r){I=!1;var n=t._newModel(e,!0,h,!1),i=null,s=null;if(null!=n){if(l=-1,n.SetupId(),i=e instanceof u?e:n,r)return g?new Promise(function(e){var o=E(t,i,void 0,n,r);b.push(o),e(o)}):t._getInternal(i,{silent:!0},r,!0).then(function(e){s=e.m;var o=E(t,i,s,n,r);b.push(o)});!g&&y&&(s=o?t._getLocal(i):t.get(i));var a=E(t,i,s,n,r);a&&b.push(a)}else b.push(!1);return Promise.resolve()}function T(t,e){return t.parse&&h.parse&&!h.noparse?t.parse(e):e}if(void 0!==d&&d<0&&(d+=this._getLength()+1),t instanceof Array?f=t:f.push(t),!o&&(this.IsVirtual()||i)){var R=this;return new Promise(function(t,e){var r=function(t){return new Promise(function(e,r){P(R,f[t],!0).then(function(){e(t+1)},r)})},n=Promise.resolve(0);for(f=T(R,f),a=0;a<f.length;a++)n=n.then(r);n.then(function(){O.length>0&&R.TriggerInternal(h.silent,s.EventType.ALLADDED,R,O,h),t(p._returnModels(b))},e)})}for(f=T(this,f),a=0;a<f.length;a++)P(this,f[a],!1);return O.length>0&&this.TriggerInternal(h.silent,s.EventType.ALLADDED,this,O,h),p._returnModels(b)},p._returnModels=function(t){return 1===t.length?t[0]:t},p.prototype._hasComparator=function(){return p._defined(this.comparator)},p.prototype.sort=function(t){var e,r,n=t||{},o=n.silent,i=this.comparator;if(!this._hasComparator())return null;if(this.IsVirtual()){var a=this.totalResults;this._hasTotalResults()?this._setModels(new Array(a),!0):(this._setModels([],!0),this._resetLRU(),this._setLength()),r=n.add?{add:!0}:null,this.TriggerInternal(o,s.EventType.SORT,this,r,null);var l=n.startIndex;return null!=l?this.setRangeLocal(l,this._getFetchSize(n)):null}return e=this,this._getModels().sort(function(t,r){return p.SortFunc(t,r,i,e,e)}),this._realignModelIndices(0),r=n.add?{add:!0}:null,this.TriggerInternal(o,s.EventType.SORT,this,r,null),null},p._getKey=function(t,e){return t instanceof u?t.get(e):l.GetPropValue(t,e)},p.SortFunc=function(t,e,n,i,s){var a,l,u,c;if(o.isFunction(n)){if(1===n.length){a=n.call(s,t),l=n.call(s,e);var h=r.StringUtils.isString(a)?a.split(","):[a],f=r.StringUtils.isString(l)?l.split(","):[l];for(u=0;u<h.length;u++)if(0!==(c=p._compareKeys(h[u],f[u],i.sortDirection)))return c}return n.call(s,t,e)}if(r.StringUtils.isString(n)){var d=n.split(",");for(u=0;u<d.length;u++)if(a=p._getKey(t,d[u]),l=p._getKey(e,d[u]),0!==(c=p._compareKeys(a,l,i.sortDirection)))return c}return 0},p.prototype.sortedIndex=function(t,e){var n,i,s=e||this.comparator;return s?(this._throwErrIfVirtual("sortedIndex"),n=this,i=function(t,e){var i,a;if(o.isFunction(s)){if(1===s.length){i=s.call(n,t),a=s.call(n,e);var l,u,c=r.StringUtils.isString(i)?i.split(","):[i],h=r.StringUtils.isString(a)?a.split(","):[a];for(u=0;u<c.length;u++)if(0!==(l=p._compareKeys(c[u],h[u],n.sortDirection)))return l}return s.call(n,t,e)}return r.StringUtils.isString(s)?(i=t.get(s),a=e.get(s),p._compareKeys(i,a,n.sortDirection)):0},p._find(this._getModels(),t,i)):-1},p._find=function(t,e,r){return function n(o,i){var s,a,l;return o>i?-1:(s=e.GetCid(),a=e.GetId(),t[o].Match(a,s)?o:t[i].Match(a,s)?i:(l=Math.floor((i+o)/2),-1===r(t[l],e)?n(o+1,l):1===r(t[l],e)?n(l,i-1):l))}(0,t.length-1)},p._compareKeys=function(t,e,r){if(-1===r){if(t<e)return 1;if(e<t)return-1}else{if(t>e)return 1;if(e>t)return-1}return 0},p.prototype.unshift=function(t,e){var n={};return r.CollectionUtils.copyInto(n,e||{}),n.at||(n.at=0),this._manageLRU(1),this._handlePromise(this._addInternal(t,n,!1,n.deferred))},p.prototype._handlePromise=function(t){return o.isFunction(t.then)?this._addPromise(function(){return t}):t},p.prototype.shift=function(t){var e,r=t||{},n=this._getDeferred(r);if(this.IsVirtual()||n){var o=this;return this._atInternal(0,r,!1,!0).then(function(t){return e=o._removeInternal(t,0,r),o.TriggerInternal(r.silent,s.EventType.ALLREMOVED,o,[e],r),e})}return e=this._removeInternal(this.at(0),0,r),this.TriggerInternal(r.silent,s.EventType.ALLREMOVED,this,[e],r),e},p.prototype.initial=function(t){var e=void 0===t?1:t;this._throwErrIfVirtual("initial");var r,n=[];for(r=0;r<this._getLength()-e;r+=1)n.push(this.at(r));return n},p.prototype._getDeferred=function(t){return(t||{}).deferred},p.prototype.last=function(t,e){var r,n=this._getDeferred(e),o=void 0===t?1:t;if(1===o)return 0===(r=this._getModelsLength())&&(r=o),r>0?this._atInternal(r-1,e,!1,n):null;var i,s=[];if(r=this._getLength(),n||this.IsVirtual()){var a=r-t;a<0&&(a=0),0===r&&(r=t);var l=this;return this._addPromise(function(){return l.IterativeAt(a,r)})}for(i=r-t;i<r;i+=1)s.push(this.at(i));return s},p.prototype.IterativeAt=function(t,e){var r,n=[],o=this;return new Promise(function(i,s){var a=function(t){return o.IsVirtual()&&o._hasTotalResults()&&t>=o.totalResults?Promise.resolve(t+1):new Promise(function(e,r){o._deferredAt(t,null).then(function(r){n.push(r),e(t+1)},r)})},l=Promise.resolve(t);for(r=t;r<e;r++)l=l.then(a);l.then(function(){i(n)},s)})},p.prototype._getDefaultFetchSize=function(t){return null==t?this[p._FETCH_SIZE_PROP]:t},p.prototype._calculateNextStart=function(){var t=this.lastFetchCount;return null==t&&(t=this[p._FETCH_SIZE_PROP]),void 0===this.offset||null===this.offset?t:this.offset+t},p.prototype.next=function(t,e){var r=e||{};r[p._FETCH_SIZE_PROP]=this._getDefaultFetchSize(t);var n=this._calculateNextStart(),o=this._getLength();if(0===o&&r[p._FETCH_SIZE_PROP]>0)n=0;else if(n>=o){return r.success&&r.success.call(u.GetContext(r,this),this,null,r),null}return r.startIndex=n,this.fetch(r)},p.prototype._calculatePrevStart=function(t){return void 0===this.offset||null===this.offset?0:this.offset-t},p.prototype.previous=function(t,e){var r=e||{};if(0===this.offset){return r.success&&this.lastFetchCount&&r.success.call(u.GetContext(r,this),this,null,r),null}r[p._FETCH_SIZE_PROP]=this._getDefaultFetchSize(t);var n=this._calculatePrevStart(r[p._FETCH_SIZE_PROP]);return n<0&&(r[p._FETCH_SIZE_PROP]=this.offset,n=0),r.startIndex=n,this.fetch(r)},p.prototype.setModelLimit=function(t){this.modelLimit=t,this._manageLRU(0)},p.prototype._getModelLimit=function(){return this.modelLimit},p.prototype.setFetchSize=function(t){this[p._FETCH_SIZE_PROP]=t},p.prototype.rest=function(t,e){var r,n=this._getDeferred(e),o=void 0===t?1:t,i=[];if(this.IsVirtual()||n){var s=this;return this._addPromise(function(){return s.IterativeAt(o,s._getLength())})}for(r=o;r<this._getLength();r+=1)i.push(this.at(r));return i},p.prototype.remove=function(t,e){var r,n=e||{},o=[];t instanceof Array?o=t:o.push(t);var i=[];for(r=o.length-1;r>=0;r-=1)i.unshift(this._removeInternal(o[r],-1,n));return this.TriggerInternal(n.silent,s.EventType.ALLREMOVED,this,o,n),p._returnModels(i)},p.prototype._removeInternal=function(t,e,n){var o=n||{},i=-1===e?this._getInternal(t):p._getModinfo(e,t),a=o.silent,l=i.index;if(l>-1){var u=i.m;void 0!==u&&u.GetCollection()===this&&u.SetCollection(null),this._spliceModels(l,1),this._setLength();var c={};r.CollectionUtils.copyInto(c,o),c.index=l,void 0!==u&&u.TriggerInternal(a,s.EventType.REMOVE,u,this,c),this._unlistenToModel(u)}return i.m},p.prototype._unlistenToModel=function(t){void 0!==t&&t.off(null,null,this)},p.prototype._listenToModel=function(t){t.OnInternal(s.EventType.ALL,this._modelEvent,this,!1,!0)},p.prototype._modelEvent=function(t,e,r,n){if(t===s.EventType.DESTROY&&this.remove(e),!(void 0!==r&&r instanceof p&&r!==this)){var o=n&&n.silent;this.TriggerInternal(o,t,e,r,n)}},p.prototype.refresh=function(t){var e,r=t||{},n=this;return this._addPromise(function(){return new Promise(function(t,o){if(!n.IsVirtual()){e=void 0!==r.silent&&r.silent;try{n.reset(null,{silent:!0});var i={};return Object.keys(r).forEach(function(t){Object.prototype.hasOwnProperty.call(r,t)&&(i[t]=r[t])}),i.success=function(r,o,i){n.TriggerInternal(e,s.EventType.REFRESH,n,i,null),t({collection:r,response:o,options:i})},i.error=function(t,e,i,s,a){o(p._createRejectionError(i,a,e,n,r,!1))},void n._fetchInternal(i,-1,!1)}catch(o){if(o instanceof a)return n.TriggerInternal(e,s.EventType.REFRESH,n,r,null),void t({collection:n,options:r});throw o}}var l=r.startIndex;n._setModels([],!0),n._resetLRU(),n.totalResults=void 0,n._setLength(),e=void 0!==r.silent&&r.silent,n.TriggerInternal(e,s.EventType.REFRESH,n,r,null),null==l&&(l=0),null!=l?n._setRangeLocalInternal(l,n._getFetchSize(r)).then(function(e){t(e)},function(t){o(t)}):t(void 0)})})},p.prototype.reset=function(t,e){var n,o,i={};r.CollectionUtils.copyInto(i,e||{}),i.previousModels=this._getModels();for(var a=0;a<this._modelIndices.length;a++)n=this._modelIndices[a],(o=this._getModel(n))&&(this._unlistenToModel(o),o.SetCollection(null));this._setModels([],!0),this._resetLRU();var l=void 0!==i.silent&&i.silent;if(!t)return this._setLength(),this.totalResults=void 0,this.TriggerInternal(l,s.EventType.RESET,this,i,null),null;var u,c=t;return i.parse&&(c=this.parse(t)),this._manageLRU(c instanceof Array?c.length:1),i.noparse=!0,u=this._addInternal(c,i,!0,!1),this._setLength(),this.TriggerInternal(l,s.EventType.RESET,this,i,null),this._handlePromise(u)},p.prototype.at=function(t,e){var r=this._getDeferred(e);return this._atInternal(t,e,!1,r)},p.prototype._atInternal=function(t,e,r,n){var o=t;if(o<0&&(o+=this._getLength()),o<0||this._overUpperLimit(o))return r||!this.IsVirtual()&&!n?null:this._addPromise(function(){return Promise.resolve(null)});var i=this;return r||!this.IsVirtual()&&!n?this._getModel(o):this._addPromise(function(){return i._deferredAt(o,e)})},p.prototype.whenReady=function(){return this._promises?this._promises:Promise.resolve()},p.prototype._addPromise=function(t){var e=this;return void 0===this._promises&&(this._promiseCount=0,this._promises=Promise.resolve()),this._promiseCount+=1,this._promises=this._promises.then(t.bind(e)).then(function(t){return e._promiseCount-=1,0===e._promiseCount&&(e._promises=void 0,e.TriggerInternal(!1,s.EventType.READY,e,null,null)),t},function(t){return e._promiseCount-=1,0===e._promiseCount&&(e._promises=void 0),Promise.reject(t)}),this._promises},p.prototype._addxhr=function(t){if(t&&t.abort){void 0===this._xhrs&&(this._xhrs=[]);var e=this;this._xhrs.push(t),t.done(function(){var r=e._xhrs?e._xhrs.indexOf(t):-1;r>-1&&e._xhrs.splice(r,1)})}},p.prototype.abort=function(){var t=this;function e(e,r){t._xhrs[e].then(function(n,o){"abort"===o&&(t._xhrs.splice(e,1),0===t._xhrs.length&&t.whenReady().then(function(){r(null)},function(){r(null)}))},function(){t._xhrs.splice(e,1),0===t._xhrs.length&&t.whenReady().then(function(){r(null)},function(){r(null)})})}return this._xhrs&&this._xhrs.length>0?new Promise(function(r){for(var n=t._xhrs.length-1;n>=0;n--)e(n,r),t._xhrs[n].abort()}):Promise.resolve()},p.prototype._deferredAt=function(t,e){var n=this,o=n._getModel(t);return new Promise(void 0===o?function(o,i){var s={};r.CollectionUtils.copyInto(s,e||{}),s.context=n,s.startIndex=t,s.error=function(t,r,o,s,a){i(p._createRejectionError(s,a,r,n,e,!1))},s.success=function(){o(n._getModel(t))},n._fetchInternal(s,-1,!1)}:function(t){t(o)})},p.prototype.getByCid=function(t){for(var e,r=this._getModels(),n=null,o=0;o<this._modelIndices.length;o++)if(r[e=this._modelIndices[o]]&&t===r[e].cid){n=r[e];break}if(n)return n;if(this.IsVirtual())throw new Error("Not found locally and not supported by server for virtual collections");return null},p.prototype.get=function(t,e){var r=this._getDeferred(e),n=this._getInternal(t,e,r);if(n){if(o.isFunction(n.then))return this._addPromise(function(){return new Promise(function(t,e){n.then(function(e){t(e.m)},function(t){e(t)})})});if(this.IsVirtual())return this._addPromise(function(){return new Promise(function(t){t(n.m)})});if(Object.prototype.hasOwnProperty.call(n,"m"))return n.m}return null},p.prototype._getLocal=function(t){var e=this._getLocalInternal(t);return e?e.m:null},p.prototype._getLocalInternal=function(t){var e=t,r=t;t instanceof u?(e=t.GetCid(),r=t.GetId()):p._defined(t)&&void 0!==t.id&&(r=t.id);for(var n,o,i=null,s=this._modelIndices.length,a=this._getModels(),l=0;l<s;l++)if(void 0!==(n=a[o=this._modelIndices[l]])&&n.Match(r,e)){i=p._getModinfo(o,n);break}return i||p._getModinfo(-1,void 0)},p.prototype._getInternal=function(t,e,n,o){var i=t,s=t,a=void 0!==o&&o;t instanceof u?(i=t.GetCid(),s=t.GetId()):p._defined(t)&&void 0!==t.id&&(s=t.id);for(var l,c=null,h=this._getModels(),f=0;f<this._modelIndices.length;f++)if(h[l=this._modelIndices[f]]&&h[l].Match(s,i)){var d=p._getModinfo(l,h[l]);c=d;break}if(c)return n?new Promise(function(t){t(c)}):c;if(this.IsVirtual()){if(void 0===s&&void 0!==i)return new Promise(function(t){t(p._getModinfo(-1,void 0))});var _=this;return new Promise(function(t,n){var o={};r.CollectionUtils.copyInto(o,e||{}),o.context=_,o.startID=s,o.error=function(t,r,o,i,s){n(p._createRejectionError(i,s,r,_,e,!1))},o.success=function(e,r){!function(e){if(null!=e){var r=_._getOffset(),n=_._getModel(r);void 0!==n&&n.Match(s,i)?t(p._getModinfo(r,n)):t(p._getModinfo(-1,void 0))}else t(p._getModinfo(-1,void 0))}(r)},_._fetchInternal(o,-1,a)})}var g=p._getModinfo(-1,void 0);return n?new Promise(function(t){t(g)}):g},p._getModinfo=function(t,e){return{index:t,m:e}},p.prototype._parseImpl=function(t){if(t instanceof Array)return t;if(!t)return t;var e;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&t[e]instanceof Array)return t[e];return t},p.prototype.parse=p.prototype._parseImpl,p.prototype._checkActual=function(t,e,r){return!!(this._hasTotalResults()&&r.start+r.count>=this.totalResults)||r.start===t&&r.count===e},p.prototype.setRangeLocal=function(t,e,r){var n=this;return this._addPromise(function(){return n._setRangeLocalInternal(t,e,r)})},p.prototype._setRangeLocalInternal=function(t,e,r){this.IsVirtual()&&this._resetModelsToFullLength(this.totalResults);var n=this._getLocalRange(t,e),o=this;if(this._checkActual(t,e,n))return new Promise(function(t){t(n)});var i=this._getModelLimit();return i>-1&&i<e&&(this.modelLimit=e),new Promise(function(n,i){o._setRangeLocalFetch(t,e,-1,{start:t,count:e},n,i,!0,r)})},p.prototype._setRangeLocalFetch=function(t,e,r,n,o,i,s,l){var u=this,c=t,h=c+e;this[p._FETCH_SIZE_PROP]&&this[p._FETCH_SIZE_PROP]>e&&(h=this[p._FETCH_SIZE_PROP]+c);var f=null;if(this.IsVirtual()){var d=this._getFirstMissingModel(c,h);d>c&&(h=(c=d)+e,this[p._FETCH_SIZE_PROP]&&this[p._FETCH_SIZE_PROP]>e&&(h=this[p._FETCH_SIZE_PROP]+c)),f={context:this,startIndex:c,fetchSize:h-c}}else f={context:this};f.error=function(t,e,r,n,o){i(p._createRejectionError(n,o,e,u,null,!1))},f.success=function(){!function(){var t=u._getLocalRange(n.start,n.count);if(s&&u._hasTotalResults()&&t.count<n.count){var r=t.start+t.count,a=c+(u.lastFetchCount?u.lastFetchCount:e);a<u.totalResults?u._setRangeLocalFetch(a,e,r,n,o,i,s,l):o(t)}else o(t)}()},l&&l.silent&&(f.silent=l.silent);try{this._fetchInternal(f,r,r>-1)}catch(t){if(t instanceof a){var _=u._getLocalRange(c,e);o(_)}}},p._createRejectionError=function(t,e,r,n,o,i){var s=!1;o&&o.silent&&(s=o.silent),i&&u._triggerError(n,s,o,e,r,t);var a=new Error(e);return a.xhr=t,a.error=r,a.collection=n,a.status=e,a},p.prototype._getMaxLength=function(t,e){var r=this._getModelsLength();return 0===r?t+e:t+e>r?r:t+e},p.prototype.isRangeLocal=function(t,e){var r=this._getLocalRange(t,e);return 0===this._getModelsLength()?0===e:t===r.start&&(e===r.count||t+e>this._getModelsLength())},p.prototype._getModelArray=function(t,e){for(var r=[],n=this._getModels(),o=t+e,i=t;i<o;i++)r.push(n[i]);return r},p.prototype._getLocalRange=function(t,e){if(!this.IsVirtual()){if(this._getModelsLength()>0){if(t+e>this._getModelsLength()){var r=this._getModelsLength()-t;return{start:t,count:r,models:this._getModelArray(t,r)}}return{start:t,count:e,models:this._getModelArray(t,e)}}return{start:t,count:0,models:[]}}var n=this._getMaxLength(t,e);if(!this._hasTotalResults()&&n<t+e)return{start:t,count:n-t,models:this._getModelArray(t,n-t)};if(0===n)return{start:t,count:0,models:[]};var o=this._getFirstMissingModel(t,n);if(o>-1)return{start:t,count:o-t,models:this._getModelArray(t,o-t)};var i=e;return t>n?i=0:t+i>n&&(i=n-t),{start:t,count:i,models:this._getModelArray(t,i)}},p.prototype._getFirstMissingModel=function(t,e){for(var r=t;r<e;r++)if(void 0===this._getModel(r))return r;return-1},p.prototype.fetch=function(t){var e=this._fetchInternal(t,-1,!1);return this._addPromise(function(){return Promise.resolve(e)}),e},p.prototype._fetchInternal=function(t,e,r){function n(t,e,r,n){t.IsVirtual()?r||t._resetModelsToFullLength(n):e.add||e.useset||t.reset(null,{silent:!0})}var o,i=t||{},a=i.success,l=i.error;return i.set&&(i.useset=!!i.set),void 0===i.parse&&(i.parse=!0),o=this,i.error=function(e,r,n){u._triggerError(o,!1,t,r,n,e),l&&l.call(u.GetContext(t,o),o,n,t,e,r)},i.success=function(l){var c,h;try{c=o.parse(l,t)}catch(e){return void p._reportError(o,e,i.error,t)}o._setPagingReturnValues(l,t,c,r)||(h=o.totalResults);var f=null,d=!1,_=e;if(i.add||o.model){n(o,i,r,h);try{-1===e&&(d=!0,_=o._getOffset()),f=o._fillInCollectionWithParsedData(c,_,d,i)}catch(e){return void p._reportError(o,e,i.error,t)}}else r||(o.IsVirtual()?(n(o,i,r,h),-1===e&&(d=!0,_=o._getOffset()),f=o._putDataIntoCollection(c,_,d)):i.useset?o._setInternal(c,!1,i,!1):o.reset(c,{silent:!0}));o.IsVirtual()&&f&&(o.lastFetchCount=f.length);var g=!!i.silent;o.TriggerInternal(g,s.EventType.SYNC,o,l,i),a&&a.call(u.GetContext(t,o),o,l,i)},this._fetchCall(i)},p.prototype._putDataIntoCollection=function(t,e,r){var n;if(t){n=t instanceof Array?t:[t];var o={};r&&this._manageLRU(n.length);for(var i=e,s=this.IsVirtual(),a=null,l=0;l<n.length;l+=1)s&&(o={at:i},a=this._atInternal(i,null,!0,!1)),o.silent=!0,this._addInternal(n[l],o,!0,!1),this._atInternal(i,null,!0,!1)!==a&&(i+=1)}return n},p.prototype._fillInCollectionWithParsedData=function(t,e,r,n){var o=n||{},i=o.parse,s=p._createModel(this),a=null;if(t){a=t instanceof Array?t:[t];var l,u={};r&&this._manageLRU(a.length);var c,h=this.IsVirtual();if(o.useset&&!h){for(c=0;c<a.length;c+=1)l=s&&i?s.parse(a[c]):a[c],a[c]=l;this._setInternal(a,!1,o,!1)}else{var f=null,d=e;for(c=0;c<a.length;c+=1)l=s&&i?s.parse(a[c]):a[c],h&&(u={at:d},f=this._atInternal(d,u,!0,!1)),u.silent=!0,this._addInternal(l,u,!0,!1),this._atInternal(d,null,!0,!1)!==f&&(d+=1)}}return a},p._reportError=function(t,e,r,o){n.error(e.toString()),r&&r.call(u.GetContext(o,t),t,e,o)},p.prototype._fetchOnly=function(t){var e,r,n=t||{},o=n.success;return void 0===n.parse&&(n.parse=!0),r=this,n.success=function(i){var a,l,c,h=null,f=[];try{c=r.parse(i,t)}catch(e){return void p._reportError(r,e,n.error,t)}if(n.add||r.model){if(l=p._createModel(r),c)for(h=c instanceof Array?c:[c],a=0;a<h.length;a+=1){if(l&&n.parse)try{e=l.parse(h[a])}catch(e){return void p._reportError(r,e,n.error,t)}else e=h[a];f.push(r._newModel(e))}}else h=c instanceof Array?c:[c];r.TriggerInternal(!1,s.EventType.SYNC,r,i,n),o&&o.call(u.GetContext(t,r),r,f,n)},this._fetchCall(n)},p.prototype._fetchCall=function(t){try{return u._internalSync("read",this,t)}catch(e){throw u._triggerError(this,!1,t,null,e,null),e}},p.prototype._resetModelsToFullLength=function(t){return void 0!==t&&this._getModelsLength()!==t&&(this._setModels(new Array(t),!0),this._resetLRU(),this._setLength(),!0)},p.prototype._getFetchSize=function(t){return(t||{})[p._FETCH_SIZE_PROP]||this[p._FETCH_SIZE_PROP]},p.prototype.IsVirtual=function(){return this._getFetchSize(null)>-1},p.prototype._getReturnProperty=function(t,e,r,n,o){var i=parseInt(p._getProp(t,e,r),10);return null==i||isNaN(i)?n||o:i},p.prototype._cleanTotalResults=function(t){if(-1!==t)return t},p.prototype._setPagingReturnValues=function(t,e,r,n){var o={};this.customPagingOptions&&((o=this.customPagingOptions.call(this,t))||(o={}));var i=e||{};this.lastFetchSize=this._getReturnProperty(o,t,"limit",i.fetchSize,this.fetchSize),this.offset=this._getReturnProperty(o,t,"offset",i.startIndex,0),this.lastFetchCount=this._getReturnProperty(o,t,"count",this.lastFetchCount,this.lastFetchCount),this.totalResults=this._cleanTotalResults(this._getReturnProperty(o,t,"totalResults",this.totalResults,this.totalResults)),this.hasMore=this._getHasMore(p._getProp(o,t,"hasMore"),this.offset,this.lastFetchSize,this.totalResults);var s=!1;if(!n){var a=this._cleanTotalResults(parseInt(p._getProp(o,t,"totalResults"),10)),l=parseInt(p._getProp(o,t,"count"),10);this.totalResults=this._adjustTotalResults(a,this.hasMore,this.offset,l,r&&Array.isArray(r)?r.length:0),s=void 0===a||isNaN(a)||null===a}return!this.IsVirtual()&&this.totalResults&&this.totalResults!==this.lastFetchCount&&this.lastFetchSize&&this.setFetchSize(this.lastFetchSize),s},p.prototype._adjustTotalResults=function(t,e,r,n,o){if(!e&&isNaN(t))return(isNaN(n)?o:n)+r;return this.totalResults},p.prototype._getHasMore=function(t,e,r,n){return p._defined(t)?t:null==n||!(e+r>n)},p._getProp=function(t,e,r){return Object.prototype.hasOwnProperty.call(t,r)?t[r]:e?e[r]:void 0},p.prototype._getOffset=function(){return p._defined(this.offset)?this.offset:0},p.prototype.create=function(t,e){var r=this,n=e||{},o=this._getDeferred(n);function i(e,r,n,o){return r.save(t instanceof u?null:t,o),r}function s(t,e){return n.wait?r.IsVirtual()||o?r._addPromise(function(){return Promise.resolve(void 0)}):null:r.add(t,e)}var a=this._newModel(t,!0,n,!1),l=n.success,c=n.context;n.validate;if(n.context=this,n.success=function(t,e,o){o.xhr&&(n.xhr=o.xhr),n.wait&&r.add(a,n),l&&l.call(null!=c?c:r,t,e,n)},null==a)return!1;n.forceNew=null!=a.GetId();var h=u._copyOptions(n);return a.SetCollection(this),o||this.IsVirtual()?new Promise(function(t){h.merge=!0,h.deferred=!0,s(a,h).then(function(){n.success=function(e,o,i){i.xhr&&(n.xhr=i.xhr),n.wait?(r.IsVirtual()&&(h.force=!0),r.add(a,h).then(function(){l&&l.call(null!=c?c:r,e,o,n),t(e)})):(l&&l.call(null!=c?c:r,e,o,n),t(e))};var e=i(0,a,0,n);e||t(e)})}):(h.merge=!0,s(a,h),i(0,a,0,n))},p.prototype.pluck=function(t){var e,r=[];for(this._throwErrIfVirtual("pluck"),e=0;e<this._getLength();e+=1)r.push(this.at(e).get(t));return r},p.prototype.where=function(t,e){return this._handlePromise(this._whereInternal(t,e))},p.prototype._whereInternal=function(t,e){var r=e||{},n=this._getDeferred(r),o=this;if(this.IsVirtual())return new Promise(function(e,n){var i={query:t,all:!0,success:function(t,r){e(r)},error:function(t,e,i){n(p._createRejectionError(t,e,i,o,r,!0))}};o._fetchOnly(i)});var i,s,a=[];for(i=0;i<this._getLength();i+=1)(s=this.at(i)).Contains(t)&&a.push(s);return n?new Promise(function(t){t(a)}):a},p.prototype.whereToCollection=function(t,e){var r=e||{},n=this._getDeferred(r),o=this;if(this.IsVirtual()||n)return o._addPromise(function(){return new Promise(function(e,n){return o._whereInternal(t,r).then(function(t){var r=o._makeNewCollection(t);e(r)},function(t){n(t)})})});var i=this._whereInternal(t,r),s=this._makeNewCollection(i);return s[p._FETCH_SIZE_PROP]=-1,s._setLength(),s},p.prototype._makeNewCollection=function(t){var e=this._cloneInternal(!1);return e._setModels(t,!1),e._resetLRU(),e._setLength(),e},p.prototype._throwErrIfVirtual=function(t){if(this.IsVirtual())throw new Error(t+" not valid on a virtual Collection")},p.prototype.map=function(t,e){var r,n=[];return this._throwErrIfVirtual("map"),this._getModels().forEach(function(o){r=t.call(e||this,o),n.push(r)}),n},p.prototype.each=function(t,e){this._throwErrIfVirtual("each"),this._getModels().forEach(t,e)},p.prototype.size=function(){return this._getLength()},p.prototype.sortBy=function(t,e){var r,n=[];return this._throwErrIfVirtual("sortBy"),this._getModels().forEach(function(t){n.push(t)}),r=this,n.sort(function(n,i){var s,a;return o.isFunction(t)?(s=t.call(e||r,n),a=t.call(e||r,i),p._compareKeys(s,a,r.sortDirection)):(s=n.get(t),a=i.get(t),p._compareKeys(s,a,r.sortDirection))}),n},p.prototype.groupBy=function(t,e){var r,n={};return this._throwErrIfVirtual("groupBy"),this._getModels().forEach(function(i){r=o.isFunction(t)?t.call(e||this,i):i.get(t),void 0===n[r]&&(n[r]=[]),n[r].push(i)},this),n},p.prototype.indexBy=function(t,e){var r,n={};return this._throwErrIfVirtual("indexBy"),this._getModels().forEach(function(i){r=o.isFunction(t)?t.call(e||this,i):i.get(t),n[r]=i},this),n},p.prototype.min=function(t,e){var r,n,o={};return this._throwErrIfVirtual("min"),0===this._getModelsLength()?null:(o=this._getModel(0),r=t.call(e||this,this._getModel(0)),this._getModels().forEach(function(i,s){s>=1&&(n=t.call(e||this,i))<r&&(o=i,r=n)},this),o)},p.prototype.max=function(t,e){var r,n,o={};return this._throwErrIfVirtual("max"),0===this._getModelsLength()?null:(o=this._getModel(0),r=t.call(e,this._getModel(0)),this._getModels().forEach(function(i,s){s>=1&&(n=t.call(e||this,i))>r&&(o=i,r=n)},this),o)},p.prototype.filter=function(t,e){var r=[];return this._throwErrIfVirtual("filter"),this._getModels().forEach(function(n){t.call(e||this,n)&&r.push(n)}),r},p.prototype.without=function(t){var e,r,n,o,i,s=[];this._throwErrIfVirtual("without");for(var a=0;a<this._getModels().length;a++){for(o=!0,i=this._getModel(a),e=0;e<arguments.length;e+=1)if(n=arguments[e].GetCid(),r=arguments[e].GetId(),i.Match(r,n)){o=!1;break}o&&s.push(i)}return s},p.prototype.difference=function(t){var e,r,n,o,i,s,a=[];this._throwErrIfVirtual("difference");for(var l=0;l<this._getModels().length;l++){for(i=!0,s=this._getModel(l),e=0;e<arguments.length;e+=1){for(r=0;r<arguments[e].length;r++)if(o=arguments[e][r].GetCid(),n=arguments[e][r].GetId(),s.Match(n,o)){i=!1;break}if(!i)break}i&&a.push(s)}return a},p.prototype.isEmpty=function(){return 0===this._getLength()},p.prototype.any=function(t,e){var r;this._throwErrIfVirtual("any");for(var n=0;n<this._getModelsLength();n+=1)if(r=this._getModel(n),t.call(e||this,r))return!0;return!1},p.prototype.findWhere=function(t,e){var r=this._getDeferred(e),n=this;if(this.IsVirtual()||r)return this._addPromise(function(){return new Promise(function(r){n._whereInternal(t,e).then(function(t){t&&t.length>0&&r(t[0]),r(null)})})});var o=this._whereInternal(t,e);return o.length>0?o[0]:null},p.prototype.slice=function(t,e,r){var n,o=this._getDeferred(r),i=[],s=e;if(void 0===s){if(this.IsVirtual()&&!this._hasTotalResults())throw new Error("End must be set for virtual collections with no totalResults");s=this._getModelsLength()}if(o||this.IsVirtual()){var a=this;return this._addPromise(function(){return a.IterativeAt(t,s)})}for(n=t;n<s;n+=1)i.push(this._getModel(n));return i},p.prototype.set=function(t,e){var r=this._getDeferred(e);return this._setInternal(t,!0,e,r||this.IsVirtual())},p._removeAfterSet=function(t,e,r,n,o){if(r)for(var i=e.length-1;i>=0;i-=1)-1===n.indexOf(i)&&t._removeInternal(e[i],i,o)},p.prototype._swapModels=function(t,e,r,n){if(this._hasComparator()||!r||!n)return{index:t,swapped:!1};var o=this._getModelsLength();if(t>=o||e>=o)return{index:t,swapped:!1};var i=this._getModel(t),s=this._getModel(e);return this._setModel(t,s),s.SetIndex(t),this._setModel(e,i),i.SetIndex(e),{index:e,swapped:e!==t}},p.prototype._setInternal=function(t,e,r,n){var o,i,a=r||{},l=void 0===a.add||a.add,u=void 0===a.remove||a.remove,c=void 0===a.merge||a.merge,h=[],f=null,d=e?this.parse(t):t;if(i=Array.isArray(d)?d:[d],n){var _=this;return this._addPromise(function(){return _._deferredSet(i,_._getModels(),a,u,l,c,e)})}var g=!1;for(o=0;o<i.length;o+=1)if(-1!==(f=this._updateModel(this._newModel(i[o],e,a,!0),l,c,n))){var y=this._swapModels(f,o,u,l),v=y.index;y.swapped&&(g=!0),-1===h.indexOf(v)&&h.push(v)}if(g){var m=a.add?{add:!0}:null;this.TriggerInternal(a.silent,s.EventType.SORT,this,m,null)}return p._removeAfterSet(this,this._getModels(),u,h,a),null},p.prototype._deferredSet=function(t,e,r,n,o,i,s){var a,l=[],u=this;return new Promise(function(c,h){var f=function(e){return new Promise(function(n,a){u._updateModel(u._newModel(t[e],s,r,!0),o,i,!0).then(function(t){-1!==t&&l.push(t),n(e+1)},a)})},d=Promise.resolve(0);for(a=0;a<t.length;a+=1)d=d.then(f);d.then(function(){p._removeAfterSet(u,e,n,l,r),c(void 0)},h)})},p.prototype._updateModel=function(t,e,r,n){function o(n,o,i){var s=o?o.index:-1,a=o?o.m:null,l={};if(a){if(r){if(l={merge:r},i)return new Promise(function(e){n._addInternal(t,l,!1,!0).then(function(){e(s)})});n.add(t,l)}}else if(e){if(i)return new Promise(function(e){n._addInternal(t,l,!1,!0).then(function(){e(n._getLength()-1)})});n.add(t),s=n._getLength()-1}return s}if(n||this.IsVirtual()){var i=this;return new Promise(function(e){i._getInternal(t,{silent:!0},n).then(function(t){o(i,t,!0).then(function(t){e(t)})})})}return o(this,this._getInternal(t),!1)},p.prototype.toJSON=function(){var t=[];return this._throwErrIfVirtual("toJSON"),this._getModels().forEach(function(e){t.push(e.toJSON())}),t},p.prototype.first=function(t,e){var r,n=this._getDeferred(e),o=this._getLength(),i=[],s=this,a=t;a?o=a:a=1;var l=this.IsVirtual()||n;if(1===a)return l?this._addPromise(function(){return s._deferredAt(0,null)}):this._getModelsLength()>0?this._getModel(0):null;if(o>this._getModelsLength()&&(this.IsVirtual()&&!this._hasTotalResults()||(o=this._getModelsLength())),l)return this._addPromise(function(){return s.IterativeAt(0,o)});for(r=0;r<o;r+=1)i.push(this._getModel(r));return i},p.prototype.indexOf=function(t,e){var r=this._getDeferred(e);if(this.IsVirtual()||r){var n=this;return this._addPromise(function(){return n._getInternal(t,null,!0).then(function(t){return t.index})})}return this._getInternal(t).index},p.prototype.contains=function(t,e){var r=this._getDeferred(e);if(this.IsVirtual()||r){var n=this;return this._addPromise(function(){return n._getInternal(t,null,!0).then(function(t){return t.index>-1})})}return this._getInternal(t).index>-1},p.prototype.include=p.prototype.contains,p.prototype._localIndexOf=function(t){var e=this._getLocalInternal(t);return void 0!==e?e.index:-1},p.prototype.pop=function(t){var e=this._getDeferred(t);if(this.IsVirtual()||e){var r=this;return this._atInternal(this._getLength()-1,t,!1,!0).then(function(e){return r.remove(e,t),e})}var n=this.at(this._getLength()-1);return this.remove(n,t),n},p.prototype.push=function(t,e){var r=this._getDeferred(e);return this._manageLRU(1),this._handlePromise(this._addInternal(t,e,!1,r))},p.prototype.lastIndexOf=function(t,e){var n,o=e;for(this._throwErrIfVirtual("lastIndexOf"),void 0===o&&(o=0),n=this._getLength()-1;n>=o;n-=1)if(r.Object.__innerEquals(t,this.at(n)))return n;return-1},p.prototype._getSortAttrs=function(t){return void 0===t?[]:t.split(",")},p._getQueryString=function(t){function e(t,e,r){return t+r+e}function r(t,r){var n,i=r;return Object.keys(t||{}).forEach(function(r){if(Object.prototype.hasOwnProperty.call(t,r))for(var s=Array.isArray(t[r])?t[r]:[t[r]],a=0;a<s.length;a++){if(u.IsComplexValue(s[a])){var l=s[a].value,c=null,h=s[a].comparator;c=o.isFunction(h)?h(null,r,l):h,n=e(r,l,c)}else n=e(r,t[r],"=");i+=n+"+"}}),i=i.substring(0,i.length-1)+","}var n,i=Array.isArray(t)?t:[t],s="";for(n=0;n<i.length;n++)s=r(i[n],s);return","===s.substring(s.length-1)?s.substring(0,s.length-1):s},p.prototype.ModifyOptionsForCustomURL=function(t){var e={};Object.keys(t||{}).forEach(function(r){Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])});var n=this.comparator;if(n&&r.StringUtils.isString(n)){for(var o=this._getSortAttrs(n),i=0;i<o.length;i++)0===i?e.sort=o[i]:e.sort+=","+o[i];e.sortDir=this._getSortDirStr()}return this.IsVirtual()&&(e[p._FETCH_SIZE_PROP]=this._getFetchSize(e)),e},p.prototype.IsUrlBased=function(t){var e=this.customURL;if(o.isFunction(e))return!0;var r=this.GetCollectionFetchUrl(t);return p._defined(r)},p.prototype.GetCollectionFetchUrl=function(t){var e=l.GetPropValue(this,"url");if(this.IsVirtual()){var n=t||{},o=n.all,i=null;if(o)i=this.totalResults||this._getFetchSize(n);else i=this._getFetchSize(n);if(e&&e.indexOf("?")>-1?e+="&":e+="?",e+="limit="+i,o||(p._defined(n.startIndex)&&(e+="&offset="+n.startIndex),n.startID&&(e+="&fromID="+n.startID),n.since&&(e+="&since="+n.since),n.until&&(e+="&until="+n.until)),n.query){var s=p._getQueryString(n.query);s&&s.length>0&&(e+="&q="+s)}var a=this.comparator;if(a&&r.StringUtils.isString(a)){var u,c=this._getSortAttrs(a),h=this._getSortDirStr();for(u=0;u<c.length;u++)e+=0===u?"&orderBy="+c[u]+":"+h:","+c[u]+":"+h}e+="&totalResults=true"}return e},p.prototype._getSortDirStr=function(){return-1===this.sortDirection?"desc":"asc"},p.prototype.sync=function(t,e,n){return r.sync(t,e,n)},p._FETCH_SIZE_PROP="fetchSize";
/**
   * @license
   * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */
var f=function t(e,r){t._init(this,r||{},e||"Authorization")};r._registerLegacyNamespaceProp("OAuth",f),r.Object.createSubclass(f,r.Object,"oj.OAuth"),f.prototype.Init=function(){f.superclass.Init.call(this)},f.prototype.getHeader=function(){var t={};return this.accessTokenResponse.access_token||this.clientCredentialGrant(),t[this.accessTokenRequest.auth_header]="Bearer "+this.accessTokenResponse.access_token,t},f.prototype.isInitialized=function(){return!(!this.accessTokenResponse||!this.accessTokenResponse.access_token)},f.prototype.clientCredentialGrant=function(){var t={},e=this;t[e.accessTokenRequest.auth_header]="Basic "+f._base64_encode(e.accessTokenRequest.client_id+":"+e.accessTokenRequest.client_secret),o.ajax({type:"POST",async:!1,url:this.accessTokenRequest.bearer_url,data:"grant_type=client_credentials",headers:t,success:function(t){e.accessTokenResponse=f._initAccessToken(e.accessTokenResponse,t)},error:function(t){throw new Error(t.responseText)}})},f.prototype.setAccessTokenResponse=function(t){this.accessTokenResopnse=f._initAccessToken(this.accessTokenResponse,t)},f.prototype.getAccessTokenResponse=function(){return this.accessTokenResponse},f.prototype.cleanAccessTokenResponse=function(){f._cleanAccessToken(this.accessTokenResponse)},f.prototype.setAccessTokenRequest=function(t){this.accessTokenRequest=f._initAccessToken(this.accessTokenRequest,t)},f.prototype.getAccessTokenRequest=function(){return this.accessTokenRequest},f.prototype.cleanAccessTokenRequest=function(){f._cleanAccessToken(this.accessTokenRequest)},f._init=function(t,e,r){var n=t;n.Init(),n.accessTokenRequest={},n.accessTokenResponse={},e.access_token?n.accessTokenResponse=f._initAccessToken(n.accessTokenResponse,e):e.client_id&&e.client_secret&&e.bearer_url&&(n.accessTokenResponse=f._initAccessToken(n.accessTokenRequest,e)),n.accessTokenRequest.auth_header=r},f._initAccessToken=function(t,e){var r=e||{},n=t||{};return Object.keys(r).forEach(function(t){Object.prototype.hasOwnProperty.call(r,t)&&(n[t]=r[t])}),n},f._cleanAccessToken=function(t){var e=t||{};Object.keys(e).forEach(function(t){Object.prototype.hasOwnProperty.call(e,t)&&"auth_header"!==t&&(e[t]=null,delete e[t])})},f._base64_encode=function(t){var e,r,n,o,i=0,s=0,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=[];do{e=t.charCodeAt(i),i+=1,r=t.charCodeAt(i),i+=1,n=t.charCodeAt(i),i+=1,e=(o=e<<16|r<<8|n)>>18&63,r=o>>12&63,n=o>>6&63,o&=63,l[s]=a.charAt(e)+a.charAt(r)+a.charAt(n)+a.charAt(o),s+=1}while(i<t.length);return l=l.join(""),((e=t.length%3)?l.slice(0,e-3):l)+"===".slice(e||3)},e.Collection=p,e.Events=s,e.Model=u,e.OAuth=f,e.URLError=a,e.ajax=h,e.sync=c,Object.defineProperty(e,"__esModule",{value:!0})})}();
//# sourceMappingURL=ojmodel.js.map