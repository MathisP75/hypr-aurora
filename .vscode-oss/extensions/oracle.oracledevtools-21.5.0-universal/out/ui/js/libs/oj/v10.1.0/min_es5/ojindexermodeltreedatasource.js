/**
 * @license
 * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","ojs/ojcore-base","ojs/ojindexer","ojs/ojdatasource-common"],function(t,e,n,i){"use strict";e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;
/**
   * @license
   * Copyright (c) 2017 2021, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */
var r=function(t,e,n,i){this.data=t,this.idAttr=e,this.listener=n,this.options=i,this.Init()};e._registerLegacyNamespaceProp("IndexerModelTreeDataSource",r),e.Object.createSubclass(r,e.TreeDataSource,"oj.IndexerModelTreeDataSource"),r.prototype.Init=function(){r.superclass.Init.call(this);var t=this.options.sections;if(null==t){var n=e.Translations.getTranslatedString("oj-ojIndexer.indexerCharacters");t=n.split("|")}t.push(e.IndexerModel.SECTION_OTHERS);var i=this.options.groupingStrategy;if(null==i){var s=this.options.groupingAttribute;i=function(n){var i=(n[s]?n[s]:n).toString().toUpperCase()[0];return t.indexOf(i)>-1?i:e.IndexerModel.SECTION_OTHERS}}var o,a=this.options.sortComparatorFunction;this.data=this.data.sort(function(e,n){var r=i(e),s=i(n),o=t.indexOf(r)-t.indexOf(s);return 0===o&&a?a(e,n):o});for(var u=0;u<this.data.length;u++){var l=i(this.data[u]);o!==l&&(o=l,this._set(l,u))}this.sections=t},r.prototype._set=function(t,e){null==this.pos&&(this.pos=[]),this.pos.push({key:t,value:e})},r.prototype._get=function(t){for(var e=0;e<this.pos.length;e++)if(this.pos[e].key===t)return this.pos[e].value;return null},r.prototype.getIndexableSections=function(){return this.sections.slice(0,this.sections.length-1)},r.prototype.getMissingSections=function(){if(null==this.missing){for(var t=[],e=0;e<this.sections.length-1;e++){var n=this.sections[e];null==this._get(n)&&t.push(n)}this.missing=t}return this.missing},r.prototype.setSection=function(t){return this.listener.call(this,t)},r.prototype.getChildCount=function(t){if(null==t){var n=this.sections.length-this.getMissingSections().length;return null!=this._get(e.IndexerModel.SECTION_OTHERS)?n:n-1}var i=this._get(t);if(null!=i){var r=this.sections.indexOf(t);if(r===this.sections.length-1)return this.data.length-i;r+=1;for(var s=this.sections[r],o=this._get(s);null==o&&r<this.sections.length;)r+=1,s=this.sections[r],o=this._get(s);return(isNaN(o)||null==o)&&(o=this.data.length),o-i}return 0},r.prototype.fetchChildren=function(t,e,n,i){var r,s=this;if(null==t){var o=this.sections.filter(function(t){return null!=s._get(t)});r={getParent:function(){return t},getStart:function(){return 0},getCount:function(){return o.length},getData:function(t){return o[t]},getMetadata:function(t){return{key:o[t],leaf:!1,depth:0}}}}else r={getParent:function(){return t},getStart:function(){return 0},getCount:function(){return s.getChildCount(t)},getData:function(e){return s.data[s._get(t)+e]},getMetadata:function(e){var n=s.data[s._get(t)+e];return{key:null!=s.idAttr?n[s.idAttr]:n,leaf:!0,depth:1}}};null!=n&&null!=n.success&&n.success.call(null,r)},r.prototype.getSortCriteria=function(){return{key:null,direction:"none"}},t.IndexerModelTreeDataSource=r,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=ojindexermodeltreedatasource.js.map