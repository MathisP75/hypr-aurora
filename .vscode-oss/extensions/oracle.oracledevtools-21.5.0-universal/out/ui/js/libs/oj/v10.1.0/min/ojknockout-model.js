/**
 * @license
 * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
 * Licensed under The Universal Permissive License (UPL), Version 1.0
 * as shown at https://oss.oracle.com/licenses/upl/
 * @ignore
 */
define(["exports","ojs/ojcore","knockout","ojs/ojmodel"],function(e,t,n,r){"use strict";t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;
/**
   * @license
   * Copyright (c) 2014, 2021, Oracle and/or its affiliates.
   * The Universal Permissive License (UPL), Version 1.0
   * as shown at https://oss.oracle.com/licenses/upl/
   * @ignore
   */
const o=function(){};t._registerLegacyNamespaceProp("KnockoutUtils",o),o.internalObjectProperty="oj._internalObj",o.underUpdateProp="oj._underUpdate",o.collUpdatingProp="oj.collectionUpdating",o.subscriptionProp="oj.collectionSubscription",o.updatingCollectionFunc="oj.collectionUpdatingFunc",o.map=function(e,t,a){var l;function i(t){return function(n){l[o.underUpdateProp]||e.set(t,n)}}if(e instanceof r.Collection){var c,p,d=new Array(e._getLength());if(l=a?n.observableArray(d):d,o._storeOriginalObject(l,e),a)for(p=0;p<e._modelIndices.length;p++)c=e._modelIndices[p],l()[c]=o.map(e._atInternal(c,null,!0,!1),t);else for(p=0;p<e._modelIndices.length;p++)c=e._modelIndices[p],l[c]=o.map(e._atInternal(c,null,!0,!1),t);var u=function(t){try{if(!l[o.underUpdateProp]){l[o.collUpdatingProp]=!0;for(var n=0;n<t.length;n++){var r=t[n].index,a=o._getModel(t[n].value),i=t[n].status;"added"===i?r>=e.length-1?e.add(a):e.add(a,{at:r}):"deleted"===i&&e._removeInternal(a,r)}e.comparator&&(l[o.underUpdateProp]=!0,l.sort(function(t,n){return o._callSort(t,n,e.comparator,e,this)}),l[o.underUpdateProp]=!1)}}catch(e){throw e}finally{l[o.collUpdatingProp]=!1}};a&&l.subscribe&&(l[o.updatingCollectionFunc]=u,l[o.subscriptionProp]=l.subscribe(u,null,"arrayChange"));e.OnInternal(r.Events.EventType.ADD,function(e,n,a){try{if(l[o.collUpdatingProp])return;if(n instanceof r.Collection){l[o.underUpdateProp]=!0;var i=n._localIndexOf(e);if(void 0!==i&&i>-1){var c=o.map(e,t);if(a.fillIn){for(var p=Array.isArray(l)?l.length:l().length;p<i;p++)l.splice(p,0,o.map(n._atInternal(p,null,!0,!1),t));l.splice(i,1,c)}else l.splice(i,0,c)}}}catch(e){throw e}finally{l[o.underUpdateProp]=!1}},void 0,void 0,!0),e.OnInternal(r.Events.EventType.REMOVE,function(e,t,n){try{if(l[o.collUpdatingProp])return;l[o.underUpdateProp]=!0;var r=n.index;l.splice(r,1)}catch(e){throw e}finally{l[o.underUpdateProp]=!1}},void 0,void 0,!0),e.OnInternal(r.Events.EventType.RESET,function(e){try{if(l[o.collUpdatingProp])return;e instanceof r.Collection&&(l[o.underUpdateProp]=!0,n.isObservable(l)?(l[o.subscriptionProp]&&l[o.subscriptionProp].dispose(),l.removeAll(),l[o.updatingCollectionFunc]&&l.subscribe(l[o.updatingCollectionFunc],null,"arrayChange")):l=[])}catch(e){throw e}finally{l[o.underUpdateProp]=!1}},void 0,void 0,!0),e.OnInternal(r.Events.EventType.SORT,function(t){try{if(l[o.collUpdatingProp])return;t instanceof r.Collection&&(l[o.underUpdateProp]=!0,l.sort(function(n,r){return o._callSort(n,r,e.comparator,t,this)}))}catch(e){throw e}finally{l[o.underUpdateProp]=!1}},void 0,void 0,!0)}else{if(void 0===e)return;l={};for(var s=e.attributes,f=Object.keys(s),v=0;v<f.length;v++){var b=f[v],g=n.observable(e.get(b));l[b]=g;var y=i(b);y._prop=b,g.subscribe&&g.subscribe(y)}e.OnInternal(r.Events.EventType.CHANGE,function(e){try{l[o.underUpdateProp]=!0;for(var t=e.changedAttributes(),r=Object.keys(t),a=0;a<r.length;a++){var i=r[a];l[i]?l[i](e.get(i)):l[i]=n.observable(e.get(i))}}catch(e){throw e}finally{l[o.underUpdateProp]=!1}},void 0,void 0,!0),o._storeOriginalObject(l,e),t&&t(l)}return l},o._getModel=function(e){return e instanceof r.Model?e:Object.prototype.hasOwnProperty.call(e,o.internalObjectProperty)?e[o.internalObjectProperty]:e},o._callSort=function(e,t,n,a,l){return r.Collection.SortFunc(o._getModel(e),o._getModel(t),n,a,l)},o._storeOriginalObject=function(e,t){Object.defineProperty(e,o.internalObjectProperty,{value:t,enumerable:!1})};const a=o.map;e.map=a,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ojknockout-model.js.map